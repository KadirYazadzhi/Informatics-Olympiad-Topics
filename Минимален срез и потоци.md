# üåä –ü–æ—Ç–æ—Ü–∏ –≤ –º—Ä–µ–∂–∏ (Advanced)

## üåä –¢–µ–æ—Ä–µ–º–∞ –∑–∞ –ú–∞–∫—Å–∏–º–∞–ª–µ–Ω –ø–æ—Ç–æ–∫ –∏ –ú–∏–Ω–∏–º–∞–ª–µ–Ω —Å—Ä–µ–∑

**–¢–µ–æ—Ä–µ–º–∞**: –°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–∏—è –ø–æ—Ç–æ–∫ –º–µ–∂–¥—É –∏–∑—Ç–æ—á–Ω–∏–∫ $S$ –∏ –∫–æ–Ω—Å—É–º–∞—Ç–æ—Ä $T$ –µ —Ä–∞–≤–Ω–∞ –Ω–∞ –∫–∞–ø–∞—Ü–∏—Ç–µ—Ç–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª–Ω–∏—è —Å—Ä–µ–∑ (Min-cut), –∫–æ–π—Ç–æ —Ä–∞–∑–¥–µ–ª—è $S$ –æ—Ç $T$.

### –ö–∞–∫–≤–æ –µ —Å—Ä–µ–∑?
–°—Ä–µ–∑ –µ —Ä–∞–∑–¥–µ–ª—è–Ω–µ—Ç–æ –Ω–∞ –≤—ä—Ä—Ö–æ–≤–µ—Ç–µ –≤ –≥—Ä–∞—Ñ–∞ –Ω–∞ –¥–≤–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ $U$ (—Å—ä–¥—ä—Ä–∂–∞—â–æ $S$) –∏ $V$ (—Å—ä–¥—ä—Ä–∂–∞—â–æ $T$). –ö–∞–ø–∞—Ü–∏—Ç–µ—Ç—ä—Ç –Ω–∞ —Å—Ä–µ–∑–∞ –µ —Å—É–º–∞—Ç–∞ –æ—Ç –∫–∞–ø–∞—Ü–∏—Ç–µ—Ç–∏—Ç–µ –Ω–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–±—Ä–∞, –∫–æ–∏—Ç–æ –∑–∞–ø–æ—á–≤–∞—Ç –≤ $U$ –∏ –∑–∞–≤—ä—Ä—à–≤–∞—Ç –≤ $V$.

### –ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ –º–∏–Ω–∏–º–∞–ª–µ–Ω —Å—Ä–µ–∑:
–°–ª–µ–¥ –∫–∞—Ç–æ –Ω–∞–º–µ—Ä–∏–º –º–∞–∫—Å–∏–º–∞–ª–Ω–∏—è –ø–æ—Ç–æ–∫ (–Ω–∞–ø—Ä. —á—Ä–µ–∑ –î–∏–Ω–∏—Ü), –º–∏–Ω–∏–º–∞–ª–Ω–∏—è—Ç —Å—Ä–µ–∑ —Å–µ —Å—ä—Å—Ç–æ–∏ –æ—Ç —Ä–µ–±—Ä–∞—Ç–∞ –º–µ–∂–¥—É:
1. –í—ä—Ä—Ö–æ–≤–µ—Ç–µ, –¥–æ—Å—Ç–∏–∂–∏–º–∏ –æ—Ç $S$ –≤ –æ—Å—Ç–∞—Ç—ä—á–Ω–∞—Ç–∞ –º—Ä–µ–∂–∞ (residual graph).
2. –í—ä—Ä—Ö–æ–≤–µ—Ç–µ, –∫–æ–∏—Ç–æ –Ω–µ —Å–∞ –¥–æ—Å—Ç–∏–∂–∏–º–∏.

---

## üí∞ –ú–∞–∫—Å–∏–º–∞–ª–µ–Ω –ø–æ—Ç–æ–∫ —Å –º–∏–Ω–∏–º–∞–ª–Ω–∞ —Ü–µ–Ω–∞ (Min-Cost Max-Flow)

–í —Ç–∞–∑–∏ –∑–∞–¥–∞—á–∞ –≤—Å—è–∫–æ —Ä–µ–±—Ä–æ –∏–º–∞ –Ω–µ —Å–∞–º–æ –∫–∞–ø–∞—Ü–∏—Ç–µ—Ç, –Ω–æ –∏ **—Ü–µ–Ω–∞** –∑–∞ –µ–¥–∏–Ω–∏—Ü–∞ –ø–æ—Ç–æ–∫. –¶–µ–ª—Ç–∞ –µ –¥–∞ –Ω–∞–º–µ—Ä–∏–º –ø–æ—Ç–æ–∫ —Å –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –∫–æ–π—Ç–æ –∏–º–∞ –º–∏–Ω–∏–º–∞–ª–Ω–∞ –æ–±—â–∞ —Ü–µ–Ω–∞.

### –ê–ª–≥–æ—Ä–∏—Ç—ä–º –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏—Ç–µ –Ω–∞–π-–∫—Ä–∞—Ç–∫–∏ –ø—ä—Ç–∏—â–∞:
1. –ù–∞–º–µ—Ä–∏ –Ω–∞–π-–∫—Ä–∞—Ç—ä–∫ –ø—ä—Ç –æ—Ç $S$ –¥–æ $T$ –≤ –æ—Å—Ç–∞—Ç—ä—á–Ω–∞—Ç–∞ –º—Ä–µ–∂–∞, –∫–∞—Ç–æ –∏–∑–ø–æ–ª–∑–≤–∞—à **—Ü–µ–Ω–∏—Ç–µ** –∫–∞—Ç–æ —Ç–µ–≥–ª–∞. (–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –ë–µ–ª–º–∞–Ω-–§–æ—Ä–¥ –∏–ª–∏ SPFA, —Ç—ä–π –∫–∞—Ç–æ –æ—Å—Ç–∞—Ç—ä—á–Ω–∞—Ç–∞ –º—Ä–µ–∂–∞ –º–æ–∂–µ –¥–∞ –∏–º–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∏ —Ü–µ–Ω–∏).
2. –ü—Ä–æ–∫–∞—Ä–∞–π –∫–æ–ª–∫–æ—Ç–æ —Å–µ –º–æ–∂–µ –ø–æ–≤–µ—á–µ –ø–æ—Ç–æ–∫ –ø—Ä–µ–∑ —Ç–æ–∑–∏ –ø—ä—Ç.
3. –ü–æ–≤—Ç–æ—Ä–∏, –¥–æ–∫–∞—Ç–æ –≤–µ—á–µ –Ω—è–º–∞ –ø—ä—Ç –æ—Ç $S$ –¥–æ $T$.

---

## üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. **–°—ä—á–µ—Ç–∞–Ω–∏—è —Å —Ç–µ–≥–ª–∞**: –ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ —Å—ä—á–µ—Ç–∞–Ω–∏–µ –≤ –¥–≤—É–ø–∞—Ä—Ç–∏—Ç–µ–Ω –≥—Ä–∞—Ñ —Å –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ —Å—É–º–∞ –Ω–∞ —Ç–µ–≥–ª–∞—Ç–∞.
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏ –º—Ä–µ–∂–∏**: –ú–∏–Ω–∏–º–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ —Ä–∞–∑—Ö–æ–¥–∏—Ç–µ –ø—Ä–∏ –¥–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞ —Å—Ç–æ–∫–∏.
3. **–°–µ–≥–º–µ–Ω—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ Min-cut –∑–∞ —Ä–∞–∑–¥–µ–ª—è–Ω–µ –Ω–∞ –ø—Ä–µ–¥–µ–Ω –ø–ª–∞–Ω –æ—Ç —Ñ–æ–Ω.

---

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ–æ—Ä–µ–º–∞—Ç–∞ –∑–∞ –º–∏–Ω–∏–º–∞–ª–Ω–∏—è —Å—Ä–µ–∑ –µ –º–æ—â–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤–æ –∑–∞ –¥–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –æ–ø—Ç–∏–º–∞–ª–Ω–æ—Å—Ç. Min-Cost Max-Flow –ø–æ–∑–≤–æ–ª—è–≤–∞ —Ä–µ—à–∞–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Å–ª–æ–∂–Ω–∏ –∏–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –∏ –ª–æ–≥–∏—Å—Ç–∏—á–Ω–∏ –∑–∞–¥–∞—á–∏, –∫–æ–∏—Ç–æ –∏–∑–≥–ª–µ–∂–¥–∞—Ç —Ç–≤—ä—Ä–¥–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏ –∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –î–ü –∏–ª–∏ –∞–ª—á–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏. üöÄ

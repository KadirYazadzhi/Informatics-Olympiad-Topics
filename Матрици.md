# üìä –ú–∞—Ç—Ä–∏—Ü–∏: –£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –ü–æ–≤–¥–∏–≥–∞–Ω–µ –≤ —Å—Ç–µ–ø–µ–Ω

## üìä –ö–∞–∫–≤–æ –µ –º–∞—Ç—Ä–∏—Ü–∞?

–ú–∞—Ç—Ä–∏—Ü–∞—Ç–∞ –µ –¥–≤—É–º–µ—Ä–µ–Ω –º–∞—Å–∏–≤ –æ—Ç —á–∏—Å–ª–∞. –í –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∏—Ç–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –∑–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤—è–Ω–µ –Ω–∞ —Å–∏—Å—Ç–µ–º–∏ –æ—Ç –ª–∏–Ω–µ–π–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è, –≥—Ä–∞—Ñ–∏ (–º–∞—Ç—Ä–∏—Ü–∞ –Ω–∞ —Å—ä—Å–µ–¥—Å—Ç–≤–æ) –∏ –ª–∏–Ω–µ–π–Ω–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.

---

## ‚úñÔ∏è –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –º–∞—Ç—Ä–∏—Ü–∏

–ó–∞ –¥–∞ —É–º–Ω–æ–∂–∏–º –¥–≤–µ –º–∞—Ç—Ä–∏—Ü–∏ $A$ ($n \times m$) –∏ $B$ ($m \times p$), —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç –µ –º–∞—Ç—Ä–∏—Ü–∞ $C$ ($n 	imes p$).
$$C_{i,j} = \sum_{k=1}^{m} A_{i,k} \cdot B_{k,j}$$

**–°–ª–æ–∂–Ω–æ—Å—Ç**: $O(n \cdot m \cdot p)$. –ó–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏ –º–∞—Ç—Ä–∏—Ü–∏ $n \times n$ —Å–ª–æ–∂–Ω–æ—Å—Ç—Ç–∞ –µ $O(n^3)$.

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ C++:
```cpp
struct Matrix {
    long long mat[MAXN][MAXN];
    int n;

    Matrix(int _n) : n(_n) {
        memset(mat, 0, sizeof(mat));
    }

    Matrix operator*(const Matrix& other) const {
        Matrix res(n);
        for (int i = 0; i < n; i++)
            for (int k = 0; k < n; k++)
                for (int j = 0; j < n; j++)
                    res.mat[i][j] = (res.mat[i][j] + mat[i][k] * other.mat[k][j]) % MOD;
        return res;
    }
};
```

---

## ‚ö° –ë—ä—Ä–∑–æ –ø–æ–≤–¥–∏–≥–∞–Ω–µ –≤ —Å—Ç–µ–ø–µ–Ω (Binary Exponentiation)

–ü–æ–∑–≤–æ–ª—è–≤–∞ –ø—Ä–µ—Å–º—è—Ç–∞–Ω–µ –Ω–∞ $A^k$ –∑–∞ $O(n^3 \log k)$ —á—Ä–µ–∑ –º–µ—Ç–æ–¥–∞ "–†–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞–¥–µ–π".

```cpp
Matrix power(Matrix a, long long k) {
    Matrix res(a.n);
    for (int i = 0; i < a.n; i++) res.mat[i][i] = 1; // –ï–¥–∏–Ω–∏—á–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞

    while (k > 0) {
        if (k % 2 == 1) res = res * a;
        a = a * a;
        k /= 2;
    }
    return res;
}
```

---

## üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. **–õ–∏–Ω–µ–π–Ω–∏ —Ä–µ–∫—É—Ä–µ–Ω—Ç–Ω–∏ —Ä–µ–¥–∏—Ü–∏**: –ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ $n$-—Ç–æ—Ç–æ —á–∏—Å–ª–æ –Ω–∞ –§–∏–±–æ–Ω–∞—á–∏ –∏–ª–∏ –¥—Ä—É–≥–∏ –ø–æ–¥–æ–±–Ω–∏ —Ä–µ–¥–∏—Ü–∏ –∑–∞ –æ–≥—Ä–æ–º–Ω–∏ $n$ ($n \le 10^{18}$).
2. **–ë—Ä–æ–π –ø—ä—Ç–∏—â–∞ –≤ –≥—Ä–∞—Ñ**: –ú–∞—Ç—Ä–∏—Ü–∞—Ç–∞ –Ω–∞ —Å—ä—Å–µ–¥—Å—Ç–≤–æ $A$, –ø–æ–≤–¥–∏–≥–Ω–∞—Ç–∞ –Ω–∞ —Å—Ç–µ–ø–µ–Ω $k$, –¥–∞–≤–∞ –≤ –∫–ª–µ—Ç–∫–∞ $A^k_{i,j}$ –±—Ä–æ—è –Ω–∞ –ø—ä—Ç–∏—â–∞—Ç–∞ —Å –¥—ä–ª–∂–∏–Ω–∞ —Ç–æ—á–Ω–æ $k$ –æ—Ç –≤—Ä—ä—Ö $i$ –¥–æ –≤—Ä—ä—Ö $j$.
3. **–ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏**: –†–æ—Ç–∞—Ü–∏—è, —Å–∫–∞–ª–∏—Ä–∞–Ω–µ –∏ —Ç—Ä–∞–Ω—Å–ª–∞—Ü–∏—è –Ω–∞ –æ–±–µ–∫—Ç–∏ –≤ 2D –∏ 3D.

---

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–∞—Ç—Ä–∏—á–Ω–æ—Ç–æ –ø–æ–≤–¥–∏–≥–∞–Ω–µ –≤ —Å—Ç–µ–ø–µ–Ω –µ –º–æ—â–µ–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑–∞ –ø—Ä–µ–≤—Ä—ä—â–∞–Ω–µ –Ω–∞ –ª–∏–Ω–µ–π–Ω–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ª–æ–≥–∞—Ä–∏—Ç–º–∏—á–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏. –¢–æ–≤–∞ –µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –ø–æ–¥—Ö–æ–¥ –∑–∞ –∑–∞–¥–∞—á–∏, –≤ –∫–æ–∏—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ç–∞ –∑–∞ –≤—Ö–æ–¥–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏ —Å–∞ –∏–∑–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –≥–æ–ª–µ–º–∏ ($10^{18}$). üöÄ

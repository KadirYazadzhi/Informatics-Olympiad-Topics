# ‚ûï –ú–æ–¥—É–ª–Ω–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞: –¢–µ–æ—Ä–∏—è –∏ –ü—Ä–∞–∫—Ç–∏–∫–∞

## üìú –î—ä–ª–±–æ–∫–∞ —Ç–µ–æ—Ä–∏—è –Ω–∞ –ú–æ–¥—É–ª–Ω–∞—Ç–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞

–ú–æ–¥—É–ª–Ω–∞—Ç–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ –µ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ –Ω–∞ –æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ. –ö–æ–≥–∞—Ç–æ –∫–∞–∂–µ–º $A <equiv B \pmod M$, –∏–º–∞–º–µ –ø—Ä–µ–¥–≤–∏–¥, —á–µ $A$ –∏ $B$ –¥–∞–≤–∞—Ç –µ–¥–∏–Ω –∏ —Å—ä—â –æ—Å—Ç–∞—Ç—ä–∫ –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ $M$, –∏–ª–∏ –µ–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ: $M$ –¥–µ–ª–∏ —Ä–∞–∑–ª–∏–∫–∞—Ç–∞ $(A - B)$.

### –°–≤–æ–π—Å—Ç–≤–∞ –Ω–∞ –∫–æ–Ω–≥—Ä—É–µ–Ω—Ü–∏–∏—Ç–µ
1. **–†–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω–æ—Å—Ç**: $A <equiv A \pmod M$.
2. **–°–∏–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç**: –ê–∫–æ $A <equiv B \pmod M$, —Ç–æ $B <equiv A \pmod M$.
3. **–¢—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç**: –ê–∫–æ $A <equiv B$ –∏ $B <equiv C$, —Ç–æ $A <equiv C \pmod M$.
4. **–°—ä–±–∏—Ä–∞–Ω–µ/–£–º–Ω–æ–∂–µ–Ω–∏–µ**: –ú–æ–∂–µ–º –¥–∞ —Å—ä–±–∏—Ä–∞–º–µ –∏ —É–º–Ω–æ–∂–∞–≤–∞–º–µ –∫–æ–Ω–≥—Ä—É–µ–Ω—Ü–∏–∏.
   - –ê–∫–æ $A <equiv B$ –∏ $C <equiv D$, —Ç–æ $A+C <equiv B+D$ –∏ $A \cdot C <equiv B \cdot D \pmod M$.

---

## üöÄ –ë—ä—Ä–∑–æ –º–æ–¥—É–ª–Ω–æ —Å—Ç–µ–ø–µ–Ω—É–≤–∞–Ω–µ (Modular Exponentiation)

–ü—Ä–µ—Å–º—è—Ç–∞–Ω–µ—Ç–æ –Ω–∞ $A^B \pmod M$ –Ω–∞–∏–≤–Ω–æ –æ—Ç–Ω–µ–º–∞ $O(B)$ –≤—Ä–µ–º–µ, –∫–æ–µ—Ç–æ –µ –±–∞–≤–Ω–æ –∑–∞ $B \approx 10^{18}$. –ò–∑–ø–æ–ª–∑–≤–∞–º–µ –º–µ—Ç–æ–¥–∞ –Ω–∞ "–¥–≤–æ–∏—á–Ω–æ—Ç–æ –ø–æ–≤–¥–∏–≥–∞–Ω–µ" (Binary Exponentiation), –∫–æ–π—Ç–æ —Ä–∞–±–æ—Ç–∏ –∑–∞ $O(\log B)$.

**–ò–¥–µ—è**: $A^{2k} = (A^k)^2$ –∏ $A^{2k+1} = A \cdot (A^k)^2$.

```cpp
long long power(long long base, long long exp, long long mod) {
    long long res = 1;
    base %= mod;
    while (exp > 0) {
        if (exp % 2 == 1) res = (__int128)res * base % mod; // –ò–∑–ø–æ–ª–∑–≤–∞–º–µ __int128 –∑–∞ –∏–∑–±—è–≥–≤–∞–Ω–µ –Ω–∞ overflow –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ—Ç–æ
        base = (__int128)base * base % mod;
        exp /= 2;
    }
    return res;
}
```
*–ó–∞–±–µ–ª–µ–∂–∫–∞: –ê–∫–æ `mod` –µ –¥–æ $10^9$, `long long` –µ –¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω. –ê–∫–æ `mod` –µ –¥–æ $10^{18}$, –º–µ–∂–¥–∏–Ω–Ω–æ—Ç–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ –¥–∞ –ø—Ä–µ–ø—ä–ª–Ω–∏ `long long`, –∑–∞—Ç–æ–≤–∞ —Å–µ –ø–æ–ª–∑–≤–∞ `__int128`.*

---

## ‚Üî –†–∞–∑—à–∏—Ä–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç—ä–º –Ω–∞ –ï–≤–∫–ª–∏–¥ (Extended Euclidean Algorithm)

–ê–ª–≥–æ—Ä–∏—Ç—ä–º—ä—Ç –Ω–∞–º–∏—Ä–∞ —Ü–µ–ª–∏ —á–∏—Å–ª–∞ $x$ –∏ $y$, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–≤–∞—â–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ—Ç–æ –Ω–∞ –ë–µ–∑—É:
$$A \cdot x + B \cdot y = \gcd(A, B)$$

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∏ (–°—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞)**:
–ó–Ω–∞–µ–º, —á–µ $\gcd(A, B) = \gcd(B, A \% B)$.
–ù–µ–∫–∞ —Å–º–µ –Ω–∞–º–µ—Ä–∏–ª–∏ $x_1, y_1$ –∑–∞ –¥–≤–æ–π–∫–∞—Ç–∞ $(B, A \% B)$, —Ç.–µ.:
$$B \cdot x_1 + (A \% B) \cdot y_1 = \gcd(A, B)$$
–ó–∞–º–µ—Å—Ç–≤–∞–º–µ $A \% B = A - \lfloor A/B \rfloor \cdot B$:
$$B \cdot x_1 + (A - \lfloor A/B \rfloor \cdot B) \cdot y_1 = \gcd$$
$$A \cdot y_1 + B \cdot (x_1 - \lfloor A/B \rfloor \cdot y_1) = \gcd$$
–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ –Ω–æ–≤–∏—Ç–µ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏ —Å–∞: $x = y_1$ –∏ $y = x_1 - \lfloor A/B \rfloor \cdot y_1$.

```cpp
long long extendedGCD(long long a, long long b, long long &x, long long &y) {
    if (a == 0) {
        x = 0; y = 1;
        return b;
    }
    long long x1, y1;
    long long gcd = extendedGCD(b % a, a, x1, y1);
    x = y1 - (b / a) * x1;
    y = x1;
    return gcd;
}
```

---

## ‚ûó –ú–æ–¥—É–ª–Ω–æ –¥–µ–ª–µ–Ω–∏–µ –∏ –û–±—Ä–∞—Ç–µ–Ω –µ–ª–µ–º–µ–Ω—Ç

–î–µ–ª–µ–Ω–∏–µ—Ç–æ $A / B \pmod M$ —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –∫–∞—Ç–æ $A \cdot B^{-1} \pmod M$.
–û–±—Ä–∞—Ç–Ω–∏—è—Ç –µ–ª–µ–º–µ–Ω—Ç $B^{-1}$ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞ —Å–∞–º–æ –∞–∫–æ $\gcd(B, M) = 1$.

### –ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ $B^{-1}$:
1. **–ê–∫–æ $M$ –µ –ø—Ä–æ—Å—Ç–æ**: –°–ø–æ—Ä–µ–¥ –ú–∞–ª–∫–∞—Ç–∞ —Ç–µ–æ—Ä–µ–º–∞ –Ω–∞ –§–µ—Ä–º–∞, $B^{M-2} \pmod M$.
2. **–ê–∫–æ $M$ –Ω–µ –µ –ø—Ä–æ—Å—Ç–æ**: –ò–∑–ø–æ–ª–∑–≤–∞–º–µ —Ä–∞–∑—à–∏—Ä–µ–Ω–∏—è –ï–≤–∫–ª–∏–¥ –∑–∞ —Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ $B \cdot x + M \cdot y = 1$. –¢—É–∫ $x$ –µ —Ç—ä—Ä—Å–µ–Ω–∏—è—Ç –æ–±—Ä–∞—Ç–µ–Ω –µ–ª–µ–º–µ–Ω—Ç (–º–æ–∂–µ –¥–∞ –µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω, –∑–∞—Ç–æ–≤–∞ –≤–∑–∏–º–∞–º–µ $(x \% M + M) \% M$).

---

## üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∞ —Ç–µ–æ—Ä–µ–º–∞ –∑–∞ –æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ (Chinese Remainder Theorem - CRT)

–ü–æ–∑–≤–æ–ª—è–≤–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ —á–∏—Å–ª–æ $x$, –∞–∫–æ –∑–Ω–∞–µ–º –æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ –º—É –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω—è–∫–æ–ª–∫–æ **–≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç–∏** —á–∏—Å–ª–∞.

–°–∏—Å—Ç–µ–º–∞:
$$x <equiv a_1 \pmod {m_1}$$
$$x <equiv a_2 \pmod {m_2}$$
...
$$x <equiv a_k \pmod {m_k}$$

–ù–µ–∫–∞ $M = m_1 \cdot m_2 \cdot \dots \cdot m_k$. –†–µ—à–µ–Ω–∏–µ—Ç–æ –µ —É–Ω–∏–∫–∞–ª–Ω–æ –ø–æ –º–æ–¥—É–ª $M$ –∏ —Å–µ –¥–∞–≤–∞ –æ—Ç —Ñ–æ—Ä–º—É–ª–∞—Ç–∞:
$$x = \left( \sum_{i=1}^{k} a_i \cdot M_i \cdot y_i \right) \pmod M$$
–ö—ä–¥–µ—Ç–æ $M_i = M / m_i$, –∞ $y_i$ –µ –º–æ–¥—É–ª–Ω–æ—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ $M_i$ —Å–ø—Ä—è–º–æ $m_i$ ($M_i \cdot y_i <equiv 1 \pmod {m_i}$). 

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–∞ —Å –º–Ω–æ–≥–æ –≥–æ–ª–µ–º–∏ —á–∏—Å–ª–∞, –∫–∞—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏—Ç–µ —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞—Ç –ø–∞—Ä–∞–ª–µ–ª–Ω–æ —Å –º–∞–ª–∫–∏ –º–æ–¥—É–ª–∏ –∏ –Ω–∞–∫—Ä–∞—è —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç —Å–µ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞.

---

## üë©‚Äçüëß –î–∏—Å–∫—Ä–µ—Ç–µ–Ω –ª–æ–≥–∞—Ä–∏—Ç—ä–º (Baby-step Giant-step)

–ó–∞–¥–∞—á–∞: –î–∞ —Å–µ –Ω–∞–º–µ—Ä–∏ $x$, —Ç–∞–∫–æ–≤–∞ —á–µ $a^x <equiv b \pmod m$.
–¢–æ–≤–∞ –µ —Ç—Ä—É–¥–Ω–∞ –∑–∞–¥–∞—á–∞, –Ω–æ –∞–ª–≥–æ—Ä–∏—Ç—ä–º—ä—Ç Baby-step Giant-step —è —Ä–µ—à–∞–≤–∞ –∑–∞ $O(\sqrt{m} \log m)$.

**–ò–¥–µ—è**: –ü—Ä–µ–¥—Å—Ç–∞–≤—è–º–µ $x = i \cdot k - j$, –∫—ä–¥–µ—Ç–æ $k = \lceil \sqrt{m} \rceil$.
–£—Ä–∞–≤–Ω–µ–Ω–∏–µ—Ç–æ —Å—Ç–∞–≤–∞ $a^{ik - j} <equiv b \implies (a^k)^i <equiv b \cdot a^j$.
1. –ü—Ä–µ—Å–º—è—Ç–∞–º–µ –¥—è—Å–Ω–∞—Ç–∞ —á–∞—Å—Ç –∑–∞ –≤—Å–∏—á–∫–∏ $0 \le j < k$ –∏ –≥–∏ –∑–∞–ø–∞–∑–≤–∞–º–µ –≤ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞ (Baby steps).
2. –ü—Ä–µ—Å–º—è—Ç–∞–º–µ –ª—è–≤–∞—Ç–∞ —á–∞—Å—Ç –∑–∞ $i = 1, \dots, k$ –∏ –ø—Ä–æ–≤–µ—Ä—è–≤–∞–º–µ –∑–∞ —Å—ä–≤–ø–∞–¥–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ (Giant steps).

---

## üêÄ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª–Ω–∞—Ç–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ –µ –≤ –æ—Å–Ω–æ–≤–∞—Ç–∞ –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—Ç–µ –∑–∞ –∫—Ä–∏–ø—Ç–∏—Ä–∞–Ω–µ (RSA) –∏ –º–Ω–æ–≥–æ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–Ω–∏ –∑–∞–¥–∞—á–∏. –£–≤–µ—Ä–µ—Ç–µ —Å–µ, —á–µ –≤–∏–Ω–∞–≥–∏ –æ–±—Ä–∞–±–æ—Ç–≤–∞—Ç–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ (`(a % n + n) % n`) –∏ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ `long long` –∑–∞ –º–µ–∂–¥–∏–Ω–Ω–∏—Ç–µ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è.
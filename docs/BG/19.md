# ‚ûï –ú–æ–¥—É–ª–Ω–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞: –¢–µ–æ—Ä–∏—è –∏ –ü—Ä–∞–∫—Ç–∏–∫–∞

## üìú –î—ä–ª–±–æ–∫–∞ —Ç–µ–æ—Ä–∏—è –Ω–∞ –ú–æ–¥—É–ª–Ω–∞—Ç–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞

–ú–æ–¥—É–ª–Ω–∞—Ç–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ –µ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ –Ω–∞ –æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ. –ö–æ–≥–∞—Ç–æ –∫–∞–∂–µ–º $A <equiv B \pmod M$, –∏–º–∞–º–µ –ø—Ä–µ–¥–≤–∏–¥, —á–µ $A$ –∏ $B$ –¥–∞–≤–∞—Ç –µ–¥–∏–Ω –∏ —Å—ä—â –æ—Å—Ç–∞—Ç—ä–∫ –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ $M$, –∏–ª–∏ –µ–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ: $M$ –¥–µ–ª–∏ —Ä–∞–∑–ª–∏–∫–∞—Ç–∞ $(A - B)$.

### –°–≤–æ–π—Å—Ç–≤–∞ –Ω–∞ –∫–æ–Ω–≥—Ä—É–µ–Ω—Ü–∏–∏—Ç–µ
1. **–†–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω–æ—Å—Ç**: $A <equiv A \pmod M$.
2. **–°–∏–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç**: –ê–∫–æ $A <equiv B \pmod M$, —Ç–æ $B <equiv A \pmod M$.
3. **–¢—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç**: –ê–∫–æ $A <equiv B$ –∏ $B <equiv C$, —Ç–æ $A <equiv C \pmod M$.
4. **–°—ä–±–∏—Ä–∞–Ω–µ/–£–º–Ω–æ–∂–µ–Ω–∏–µ**: –ú–æ–∂–µ–º –¥–∞ —Å—ä–±–∏—Ä–∞–º–µ –∏ —É–º–Ω–æ–∂–∞–≤–∞–º–µ –∫–æ–Ω–≥—Ä—É–µ–Ω—Ü–∏–∏.
   - –ê–∫–æ $A <equiv B$ –∏ $C <equiv D$, —Ç–æ $A+C <equiv B+D$ –∏ $A \cdot C <equiv B \cdot D \pmod M$.

---

## üöÄ –ë—ä—Ä–∑–æ –º–æ–¥—É–ª–Ω–æ —Å—Ç–µ–ø–µ–Ω—É–≤–∞–Ω–µ (Modular Exponentiation)

–ü—Ä–µ—Å–º—è—Ç–∞–Ω–µ—Ç–æ –Ω–∞ $A^B \pmod M$ –Ω–∞–∏–≤–Ω–æ –æ—Ç–Ω–µ–º–∞ $O(B)$ –≤—Ä–µ–º–µ, –∫–æ–µ—Ç–æ –µ –±–∞–≤–Ω–æ –∑–∞ $B \approx 10^{18}$. –ò–∑–ø–æ–ª–∑–≤–∞–º–µ –º–µ—Ç–æ–¥–∞ –Ω–∞ "–¥–≤–æ–∏—á–Ω–æ—Ç–æ –ø–æ–≤–¥–∏–≥–∞–Ω–µ" (Binary Exponentiation), –∫–æ–π—Ç–æ —Ä–∞–±–æ—Ç–∏ –∑–∞ $O(\log B)$.

**–ò–¥–µ—è**: $A^{2k} = (A^k)^2$ –∏ $A^{2k+1} = A \cdot (A^k)^2$.

```cpp
long long power(long long base, long long exp, long long mod) {
    long long res = 1;
    base %= mod;
    while (exp > 0) {
        if (exp % 2 == 1) res = (__int128)res * base % mod; // –ò–∑–ø–æ–ª–∑–≤–∞–º–µ __int128 –∑–∞ –∏–∑–±—è–≥–≤–∞–Ω–µ –Ω–∞ overflow –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ—Ç–æ
        base = (__int128)base * base % mod;
        exp /= 2;
    }
    return res;
}
```
*–ó–∞–±–µ–ª–µ–∂–∫–∞: –ê–∫–æ `mod` –µ –¥–æ $10^9$, `long long` –µ –¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω. –ê–∫–æ `mod` –µ –¥–æ $10^{18}$, –º–µ–∂–¥–∏–Ω–Ω–æ—Ç–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ –¥–∞ –ø—Ä–µ–ø—ä–ª–Ω–∏ `long long`, –∑–∞—Ç–æ–≤–∞ —Å–µ –ø–æ–ª–∑–≤–∞ `__int128`.*

---

## ‚Üî –†–∞–∑—à–∏—Ä–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç—ä–º –Ω–∞ –ï–≤–∫–ª–∏–¥ (Extended Euclidean Algorithm)

–ê–ª–≥–æ—Ä–∏—Ç—ä–º—ä—Ç –Ω–∞–º–∏—Ä–∞ —Ü–µ–ª–∏ —á–∏—Å–ª–∞ $x$ –∏ $y$, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–≤–∞—â–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ—Ç–æ –Ω–∞ –ë–µ–∑—É:
$$A \cdot x + B \cdot y = \gcd(A, B)$$

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∏ (–°—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞)**:
–ó–Ω–∞–µ–º, —á–µ $\gcd(A, B) = \gcd(B, A \% B)$.
–ù–µ–∫–∞ —Å–º–µ –Ω–∞–º–µ—Ä–∏–ª–∏ $x_1, y_1$ –∑–∞ –¥–≤–æ–π–∫–∞—Ç–∞ $(B, A \% B)$, —Ç.–µ.:
$$B \cdot x_1 + (A \% B) \cdot y_1 = \gcd(A, B)$$
–ó–∞–º–µ—Å—Ç–≤–∞–º–µ $A \% B = A - \lfloor A/B \rfloor \cdot B$:
$$B \cdot x_1 + (A - \lfloor A/B \rfloor \cdot B) \cdot y_1 = \gcd$$
$$A \cdot y_1 + B \cdot (x_1 - \lfloor A/B \rfloor \cdot y_1) = \gcd$$
–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ –Ω–æ–≤–∏—Ç–µ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏ —Å–∞: $x = y_1$ –∏ $y = x_1 - \lfloor A/B \rfloor \cdot y_1$.

```cpp
long long extendedGCD(long long a, long long b, long long &x, long long &y) {
    if (a == 0) {
        x = 0; y = 1;
        return b;
    }
    long long x1, y1;
    long long gcd = extendedGCD(b % a, a, x1, y1);
    x = y1 - (b / a) * x1;
    y = x1;
    return gcd;
}
```

---

## ‚ûó –ú–æ–¥—É–ª–Ω–æ –¥–µ–ª–µ–Ω–∏–µ –∏ –û–±—Ä–∞—Ç–µ–Ω –µ–ª–µ–º–µ–Ω—Ç

–î–µ–ª–µ–Ω–∏–µ—Ç–æ $A / B \pmod M$ —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –∫–∞—Ç–æ $A \cdot B^{-1} \pmod M$.
–û–±—Ä–∞—Ç–Ω–∏—è—Ç –µ–ª–µ–º–µ–Ω—Ç $B^{-1}$ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞ —Å–∞–º–æ –∞–∫–æ $\gcd(B, M) = 1$.

### –ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ $B^{-1}$:
1. **–ê–∫–æ $M$ –µ –ø—Ä–æ—Å—Ç–æ**: –°–ø–æ—Ä–µ–¥ –ú–∞–ª–∫–∞—Ç–∞ —Ç–µ–æ—Ä–µ–º–∞ –Ω–∞ –§–µ—Ä–º–∞, $B^{M-2} \pmod M$.
2. **–ê–∫–æ $M$ –Ω–µ –µ –ø—Ä–æ—Å—Ç–æ**: –ò–∑–ø–æ–ª–∑–≤–∞–º–µ —Ä–∞–∑—à–∏—Ä–µ–Ω–∏—è –ï–≤–∫–ª–∏–¥ –∑–∞ —Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ $B \cdot x + M \cdot y = 1$. –¢—É–∫ $x$ –µ —Ç—ä—Ä—Å–µ–Ω–∏—è—Ç –æ–±—Ä–∞—Ç–µ–Ω –µ–ª–µ–º–µ–Ω—Ç (–º–æ–∂–µ –¥–∞ –µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω, –∑–∞—Ç–æ–≤–∞ –≤–∑–∏–º–∞–º–µ $(x \% M + M) \% M$).

---

## üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∞ —Ç–µ–æ—Ä–µ–º–∞ –∑–∞ –æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ (Chinese Remainder Theorem - CRT)

–ü–æ–∑–≤–æ–ª—è–≤–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ —á–∏—Å–ª–æ $x$, –∞–∫–æ –∑–Ω–∞–µ–º –æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ –º—É –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω—è–∫–æ–ª–∫–æ **–≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç–∏** —á–∏—Å–ª–∞.

–°–∏—Å—Ç–µ–º–∞:
$$x <equiv a_1 \pmod {m_1}$$
$$x <equiv a_2 \pmod {m_2}$$
...
$$x <equiv a_k \pmod {m_k}$$

–ù–µ–∫–∞ $M = m_1 \cdot m_2 \cdot \dots \cdot m_k$. –†–µ—à–µ–Ω–∏–µ—Ç–æ –µ —É–Ω–∏–∫–∞–ª–Ω–æ –ø–æ –º–æ–¥—É–ª $M$ –∏ —Å–µ –¥–∞–≤–∞ –æ—Ç —Ñ–æ—Ä–º—É–ª–∞—Ç–∞:
$$x = \left( \sum_{i=1}^{k} a_i \cdot M_i \cdot y_i \right) \pmod M$$
–ö—ä–¥–µ—Ç–æ $M_i = M / m_i$, –∞ $y_i$ –µ –º–æ–¥—É–ª–Ω–æ—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ $M_i$ —Å–ø—Ä—è–º–æ $m_i$ ($M_i \cdot y_i <equiv 1 \pmod {m_i}$). 

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–∞ —Å –º–Ω–æ–≥–æ –≥–æ–ª–µ–º–∏ —á–∏—Å–ª–∞, –∫–∞—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏—Ç–µ —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞—Ç –ø–∞—Ä–∞–ª–µ–ª–Ω–æ —Å –º–∞–ª–∫–∏ –º–æ–¥—É–ª–∏ –∏ –Ω–∞–∫—Ä–∞—è —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç —Å–µ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞.

---

## üë©‚Äçüëß –î–∏—Å–∫—Ä–µ—Ç–µ–Ω –ª–æ–≥–∞—Ä–∏—Ç—ä–º (Baby-step Giant-step)

–ó–∞–¥–∞—á–∞: –î–∞ —Å–µ –Ω–∞–º–µ—Ä–∏ $x$, —Ç–∞–∫–æ–≤–∞ —á–µ $a^x <equiv b \pmod m$.
–¢–æ–≤–∞ –µ —Ç—Ä—É–¥–Ω–∞ –∑–∞–¥–∞—á–∞, –Ω–æ –∞–ª–≥–æ—Ä–∏—Ç—ä–º—ä—Ç Baby-step Giant-step —è —Ä–µ—à–∞–≤–∞ –∑–∞ $O(\sqrt{m} \log m)$.

**–ò–¥–µ—è**: –ü—Ä–µ–¥—Å—Ç–∞–≤—è–º–µ $x = i \cdot k - j$, –∫—ä–¥–µ—Ç–æ $k = \lceil \sqrt{m} \rceil$.
–£—Ä–∞–≤–Ω–µ–Ω–∏–µ—Ç–æ —Å—Ç–∞–≤–∞ $a^{ik - j} <equiv b \implies (a^k)^i <equiv b \cdot a^j$.
1. –ü—Ä–µ—Å–º—è—Ç–∞–º–µ –¥—è—Å–Ω–∞—Ç–∞ —á–∞—Å—Ç –∑–∞ –≤—Å–∏—á–∫–∏ $0 \le j < k$ –∏ –≥–∏ –∑–∞–ø–∞–∑–≤–∞–º–µ –≤ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞ (Baby steps).
2. –ü—Ä–µ—Å–º—è—Ç–∞–º–µ –ª—è–≤–∞—Ç–∞ —á–∞—Å—Ç –∑–∞ $i = 1, \dots, k$ –∏ –ø—Ä–æ–≤–µ—Ä—è–≤–∞–º–µ –∑–∞ —Å—ä–≤–ø–∞–¥–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ (Giant steps).

---

## üßÆ –ú–æ–¥—É–ª–µ–Ω —Ñ–∞–∫—Ç–æ—Ä–∏–µ–ª –∏ –ë–∏–Ω–æ–º–∏–∞–ª–Ω–∏ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏

### –ü—Ä–µ—Å–º—è—Ç–∞–Ω–µ –Ω–∞ —Ñ–∞–∫—Ç–æ—Ä–∏–µ–ª –ø–æ –º–æ–¥—É–ª
–ó–∞ –≥–æ–ª–µ–º–∏ $N$, –¥–∏—Ä–µ–∫—Ç–Ω–æ—Ç–æ –ø—Ä–µ—Å–º—è—Ç–∞–Ω–µ –Ω–∞ $N!$ –µ –Ω–µ–≤—ä–∑–º–æ–∂–Ω–æ. –ò–∑–ø–æ–ª–∑–≤–∞–º–µ –º–æ–¥—É–ª–Ω–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞.
```cpp
long long factorialMod(int n, long long mod) {
    long long result = 1;
    for (int i = 2; i <= n; i++) {
        result = (result * i) % mod;
    }
    return result;
}
```

### –ë–∏–Ω–æ–º–∏–∞–ª–Ω–∏ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏ –ø–æ –º–æ–¥—É–ª
$\binom{n}{k} = \frac{n!}{k! \cdot (n-k)!}$. –ó–∞ –ø—Ä–µ—Å–º—è—Ç–∞–Ω–µ –ø–æ –º–æ–¥—É–ª –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –æ–±—Ä–∞—Ç–µ–Ω –µ–ª–µ–º–µ–Ω—Ç.
```cpp
long long binomialMod(int n, int k, long long mod) {
    if (k > n) return 0;
    
    vector<long long> fact(n + 1);
    fact[0] = 1;
    for (int i = 1; i <= n; i++) {
        fact[i] = (fact[i-1] * i) % mod;
    }
    
    long long denominator = (fact[k] * fact[n - k]) % mod;
    long long inv = power(denominator, mod - 2, mod); // –ò–∑–ø–æ–ª–∑–≤–∞–º–µ –§–µ—Ä–º–∞
    
    return (fact[n] * inv) % mod;
}
```

### –¢—Ä–∏—ä–≥—ä–ª–Ω–∏–∫ –Ω–∞ –ü–∞—Å–∫–∞–ª
–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–µ–Ω –º–µ—Ç–æ–¥ –∑–∞ –º–∞–ª–∫–∏ $N$ –∏ $K$ –±–µ–∑ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –¥–µ–ª–µ–Ω–∏–µ.
```cpp
long long pascal[1005][1005];

void buildPascal(int maxN, long long mod) {
    for (int n = 0; n <= maxN; n++) {
        pascal[n][0] = 1;
        for (int k = 1; k <= n; k++) {
            pascal[n][k] = (pascal[n-1][k-1] + pascal[n-1][k]) % mod;
        }
    }
}
```

## üîê –¢–µ–æ—Ä–µ–º–∞ –Ω–∞ –û–π–ª–µ—Ä (–û–±–æ–±—â–µ–Ω–∏–µ –Ω–∞ –§–µ—Ä–º–∞)
–ó–∞ –≤—Å—è–∫–æ —á–∏—Å–ª–æ $A$ –∏ $M$, –∫—ä–¥–µ—Ç–æ $\gcd(A, M) = 1$:
$$A^{\phi(M)} \equiv 1 \pmod M$$
–ö—ä–¥–µ—Ç–æ $\phi(M)$ –µ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ –Ω–∞ –û–π–ª–µ—Ä (–±—Ä–æ–π —á–∏—Å–ª–∞ –¥–æ $M$, –≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç–∏ —Å $M$).

**–°–ª–µ–¥—Å—Ç–≤–∏–µ**: $A^{-1} \equiv A^{\phi(M) - 1} \pmod M$.

### –§—É–Ω–∫—Ü–∏—è –Ω–∞ –û–π–ª–µ—Ä (Euler's Totient)
```cpp
int phi(int n) {
    int result = n;
    for (int p = 2; p * p <= n; p++) {
        if (n % p == 0) {
            while (n % p == 0) n /= p;
            result -= result / p;
        }
    }
    if (n > 1) result -= result / n;
    return result;
}
```

## üé≤ –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Å–ª—É—á–∞–π–Ω–∏ —á–∏—Å–ª–∞ –ø–æ –º–æ–¥—É–ª
–ü—Ä–∏ —Ä–∞–±–æ—Ç–∞ —Å —Ö–µ—à —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–∞–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ —á–µ—Å—Ç–æ –µ –Ω—É–∂–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Å–ª—É—á–∞–π–Ω–∏ —á–∏—Å–ª–∞.
```cpp
#include <random>

mt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count());

long long randomMod(long long mod) {
    return uniform_int_distribution<long long>(0, mod - 1)(rng);
}
```

## üî¢ –ú–æ–¥—É–ª–Ω–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ –≤ –º–∞—Ç—Ä–∏—Ü–∏
–£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –º–∞—Ç—Ä–∏—Ü–∏ –ø–æ –º–æ–¥—É–ª –∑–∞ –±—ä—Ä–∑–æ –ø—Ä–µ—Å–º—è—Ç–∞–Ω–µ –Ω–∞ —Ä–µ–∫—É—Ä–µ–Ω—Ç–Ω–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

### –ü—Ä–∏–º–µ—Ä: N-—Ç–æ —á–∏—Å–ª–æ –Ω–∞ –§–∏–±–æ–Ω–∞—á–∏ –∑–∞ O(log N)
```cpp
typedef vector<vector<long long>> Matrix;

Matrix multiply(const Matrix& A, const Matrix& B, long long mod) {
    int n = A.size();
    Matrix C(n, vector<long long>(n, 0));
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            for (int k = 0; k < n; k++) {
                C[i][j] = (C[i][j] + A[i][k] * B[k][j]) % mod;
            }
        }
    }
    return C;
}

Matrix matrixPower(Matrix A, long long p, long long mod) {
    int n = A.size();
    Matrix result(n, vector<long long>(n, 0));
    for (int i = 0; i < n; i++) result[i][i] = 1; // –ï–¥–∏–Ω–∏—á–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞
    
    while (p > 0) {
        if (p % 2 == 1) result = multiply(result, A, mod);
        A = multiply(A, A, mod);
        p /= 2;
    }
    return result;
}

long long fibonacci(long long n, long long mod) {
    if (n <= 1) return n;
    Matrix F = {{1, 1}, {1, 0}};
    F = matrixPower(F, n - 1, mod);
    return F[0][0];
}
```

## üß© –õ–∏–Ω–µ–π–Ω–∏ –¥–∏–æ—Ñ–∞–Ω—Ç–æ–≤–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
–£—Ä–∞–≤–Ω–µ–Ω–∏—è –æ—Ç –≤–∏–¥–∞ $Ax + By = C$.

**–†–µ—à–µ–Ω–∏–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞** —Å–∞–º–æ –∞–∫–æ $\gcd(A, B)$ –¥–µ–ª–∏ $C$.

```cpp
bool linearDiophantine(long long A, long long B, long long C, long long &x, long long &y) {
    long long g = extendedGCD(A, B, x, y);
    if (C % g != 0) return false; // –ù—è–º–∞ —Ä–µ—à–µ–Ω–∏–µ
    
    // –ú–∞—â–∞–±–∏—Ä–∞–Ω–µ –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ—Ç–æ
    x *= C / g;
    y *= C / g;
    return true;
}
```

**–û–±—â–æ —Ä–µ—à–µ–Ω–∏–µ**: –ê–∫–æ $(x_0, y_0)$ –µ –µ–¥–Ω–æ —Ä–µ—à–µ–Ω–∏–µ, —Ç–æ –≤—Å–∏—á–∫–∏ —Ä–µ—à–µ–Ω–∏—è —Å–∞:
$$x = x_0 + \frac{B}{\gcd(A, B)} \cdot t$$
$$y = y_0 - \frac{A}{\gcd(A, B)} \cdot t$$
–ö—ä–¥–µ—Ç–æ $t$ –µ –ø—Ä–æ–∏–∑–≤–æ–ª–Ω–æ —Ü—è–ª–æ —á–∏—Å–ª–æ.

## üè™ –ó–∞–¥–∞—á–∞: –†–∞–∑–º—è–Ω–∞ –Ω–∞ –ø–∞—Ä–∏ (Coin Change)
–ò–º–∞–º–µ –º–æ–Ω–µ—Ç–∏ —Å –Ω–æ–º–∏–Ω–∞–ª–∏ $c_1, c_2, \ldots, c_k$ –∏ –∏—Å–∫–∞–º–µ –¥–∞ —Ä–∞–∑–º–µ–Ω–∏–º —Å—É–º–∞ $S$. –ö–æ–ª–∫–æ –Ω–∞—á–∏–Ω–∞ –∏–º–∞?

### –†–µ—à–µ–Ω–∏–µ —Å –¥–∏–Ω–∞–º–∏—á–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ –ø–æ –º–æ–¥—É–ª
```cpp
long long coinChange(vector<int>& coins, int S, long long mod) {
    vector<long long> dp(S + 1, 0);
    dp[0] = 1;
    
    for (int coin : coins) {
        for (int i = coin; i <= S; i++) {
            dp[i] = (dp[i] + dp[i - coin]) % mod;
        }
    }
    
    return dp[S];
}
```

## üéØ –ó–∞–¥–∞—á–∞: –°—Ç–µ–ø–µ–Ω–Ω–∞ –∫—É–ª–∞ (Power Tower)
–ü—Ä–µ—Å–º–µ—Ç–Ω–µ—Ç–µ $A^{B^{C^{\ldots}}} \pmod M$.

**–¢–µ–æ—Ä–µ–º–∞**: –ê–∫–æ $B \ge \log_2 M$, —Ç–æ $A^B \equiv A^{(B \bmod \phi(M)) + \phi(M)} \pmod M$.

```cpp
long long powerTower(long long a, long long b, long long mod) {
    if (mod == 1) return 0;
    if (b == 0) return 1;
    
    long long phi_m = phi(mod);
    long long exp = powerTower(a, b - 1, phi_m);
    
    if (b > 1 && a >= log2(mod)) {
        exp += phi_m;
    }
    
    return power(a, exp, mod);
}
```

## üåü –ß–µ—Å—Ç–æ —Å—Ä–µ—â–∞–Ω–∏ –º–æ–¥—É–ª–∏ –≤ —Å—ä—Å—Ç–µ–∑–∞–Ω–∏—è
*   **MOD = 1e9 + 7 (1000000007)**: –ü—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ, –ø–æ–∑–≤–æ–ª—è–≤–∞ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –ú–∞–ª–∫–∞—Ç–∞ —Ç–µ–æ—Ä–µ–º–∞ –Ω–∞ –§–µ—Ä–º–∞.
*   **MOD = 998244353**: –ü—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ –æ—Ç –≤–∏–¥–∞ $2^{23} \times 119 + 1$, –∏–º–∞ –ø—Ä–∏–º–∏—Ç–∏–≤–µ–Ω –∫–æ—Ä–µ–Ω, –ø–æ–ª–µ–∑–Ω–æ –∑–∞ NTT (Number Theoretic Transform).
*   **MOD = 10^9 + 9**: –î—Ä—É–≥–æ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ.

## üìù –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å—ä–≤–µ—Ç–∏

1. **–í–∏–Ω–∞–≥–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∏—Ä–∞–π—Ç–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∏ —á–∏—Å–ª–∞**:
   ```cpp
   int normalize(int x, int mod) {
       x %= mod;
       if (x < 0) x += mod;
       return x;
   }
   ```

2. **–í–Ω–∏–º–∞–≤–∞–π—Ç–µ —Å overflow –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ**:
   ```cpp
   long long safeMul(long long a, long long b, long long mod) {
       return (__int128)a * b % mod;
   }
   ```

3. **–ü—Ä–µ–¥–ø—Ä–µ—Å–º–µ—Ç–Ω–µ—Ç–µ —Ñ–∞–∫—Ç–æ—Ä–∏–µ–ª–∏ –∏ –æ–±—Ä–∞—Ç–Ω–∏**:
   –ö–æ–≥–∞—Ç–æ –∏–º–∞—Ç–µ –º–Ω–æ–≥–æ –∑–∞–ø–∏—Ç–≤–∞–Ω–∏—è –∑–∞ –±–∏–Ω–æ–º–∏–∞–ª–Ω–∏ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏.
   ```cpp
   const int MAXN = 1000005;
   const long long MOD = 1e9 + 7;
   long long fact[MAXN], invFact[MAXN];
   
   void precompute() {
       fact[0] = 1;
       for (int i = 1; i < MAXN; i++) {
           fact[i] = fact[i-1] * i % MOD;
       }
       invFact[MAXN - 1] = power(fact[MAXN - 1], MOD - 2, MOD);
       for (int i = MAXN - 2; i >= 0; i--) {
           invFact[i] = invFact[i + 1] * (i + 1) % MOD;
       }
   }
   
   long long C(int n, int k) {
       if (k > n || k < 0) return 0;
       return fact[n] * invFact[k] % MOD * invFact[n - k] % MOD;
   }
   ```

## üß™ –ó–∞–¥–∞—á–∏ –∑–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞

1. **–°—Ç–µ–ø–µ–Ω—É–≤–∞–Ω–µ**: –ü—Ä–µ—Å–º–µ—Ç–Ω–µ—Ç–µ $A^B \bmod M$ –∑–∞ $B \le 10^{18}$.
2. **–ú–æ–¥—É–ª–Ω–æ –¥–µ–ª–µ–Ω–∏–µ**: –ü—Ä–µ—Å–º–µ—Ç–Ω–µ—Ç–µ $\frac{A}{B} \bmod M$, –∫—ä–¥–µ—Ç–æ $M$ –µ –ø—Ä–æ—Å—Ç–æ.
3. **–§–∞–∫—Ç–æ—Ä–∏–µ–ª**: –ü—Ä–µ—Å–º–µ—Ç–Ω–µ—Ç–µ $N! \bmod M$ –∑–∞ $N \le 10^6$.
4. **–ë–∏–Ω–æ–º–∏–∞–ª–Ω–∏ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏**: –û—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ –Ω–∞ $Q$ –∑–∞–ø–∏—Ç–≤–∞–Ω–∏—è –∑–∞ $\binom{N}{K} \bmod M$.
5. **–§–∏–±–æ–Ω–∞—á–∏**: –ù–∞–º–µ—Ä–µ—Ç–µ $N$-—Ç–æ—Ç–æ —á–∏—Å–ª–æ –Ω–∞ –§–∏–±–æ–Ω–∞—á–∏ –ø–æ –º–æ–¥—É–ª $M$ –∑–∞ $N \le 10^{18}$.
6. **–õ–∏–Ω–µ–π–Ω–æ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ**: –†–µ—à–µ—Ç–µ $Ax \equiv C \pmod M$.
7. **–î–∏—Å–∫—Ä–µ—Ç–µ–Ω –ª–æ–≥–∞—Ä–∏—Ç—ä–º**: –ù–∞–º–µ—Ä–µ—Ç–µ $x$, —Ç–∞–∫–æ–≤–∞ —á–µ $A^x \equiv B \pmod M$.
8. **–ö–∏—Ç–∞–π—Å–∫–∞ —Ç–µ–æ—Ä–µ–º–∞**: –†–µ—à–µ—Ç–µ —Å–∏—Å—Ç–µ–º–∞ –æ—Ç –∫–æ–Ω–≥—Ä—É–µ–Ω—Ü–∏–∏.

## üêÄ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª–Ω–∞—Ç–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ –µ –≤ –æ—Å–Ω–æ–≤–∞—Ç–∞ –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—Ç–µ –∑–∞ –∫—Ä–∏–ø—Ç–∏—Ä–∞–Ω–µ (RSA) –∏ –º–Ω–æ–≥–æ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–Ω–∏ –∑–∞–¥–∞—á–∏. –£–≤–µ—Ä–µ—Ç–µ —Å–µ, —á–µ –≤–∏–Ω–∞–≥–∏ –æ–±—Ä–∞–±–æ—Ç–≤–∞—Ç–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ (`(a % n + n) % n`) –∏ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ `long long` –∑–∞ –º–µ–∂–¥–∏–Ω–Ω–∏—Ç–µ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è. –ë—ä—Ä–∑–æ—Ç–æ —Å—Ç–µ–ø–µ–Ω—É–≤–∞–Ω–µ, –æ–±—Ä–∞—Ç–Ω–∏—è—Ç –µ–ª–µ–º–µ–Ω—Ç –∏ —Ä–∞–∑—à–∏—Ä–µ–Ω–∏—è—Ç –∞–ª–≥–æ—Ä–∏—Ç—ä–º –Ω–∞ –ï–≤–∫–ª–∏–¥ —Å–∞ –æ—Å–Ω–æ–≤–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∫–æ–∏—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –≤–ª–∞–¥–µ–µ—Ç–µ –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–æ. –ö–∏—Ç–∞–π—Å–∫–∞—Ç–∞ —Ç–µ–æ—Ä–µ–º–∞ –∑–∞ –æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ –∏ —Ç–µ–æ—Ä–µ–º–∞—Ç–∞ –Ω–∞ –û–π–ª–µ—Ä —Ä–∞–∑—à–∏—Ä—è–≤–∞—Ç –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏—Ç–µ –∑–∞ —Ä–∞–±–æ—Ç–∞ —Å—ä—Å —Å–ª–æ–∂–Ω–∏ –º–æ–¥—É–ª–Ω–∏ –∑–∞–¥–∞—á–∏. –ü—Ä–∞–∫—Ç–∏–∫—É–≤–∞–π—Ç–µ —Ä–µ–¥–æ–≤–Ω–æ, –∑–∞ –¥–∞ —Ä–∞–∑–≤–∏–µ—Ç–µ –∏–Ω—Ç—É–∏—Ü–∏—è –∏ —Å–∫–æ—Ä–æ—Å—Ç –ø—Ä–∏ —Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ –∑–∞–¥–∞—á–∏ —Å –º–æ–¥—É–ª–Ω–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞.
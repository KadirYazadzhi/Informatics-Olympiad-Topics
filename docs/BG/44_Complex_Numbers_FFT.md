# üìê –ö–æ–º–ø–ª–µ–∫—Å–Ω–∏ —á–∏—Å–ª–∞ –∏ FFT: –ï–∫—Å–ø–µ—Ä—Ç–Ω–æ –Ω–∏–≤–æ

–¢–∞–∑–∏ —Ç–µ–º–∞ –ø–æ–∫—Ä–∏–≤–∞ —Ä–∞–±–æ—Ç–∞—Ç–∞ —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏ —á–∏—Å–ª–∞ –≤ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–Ω–æ—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ –∏ –µ–¥–∏–Ω –æ—Ç –Ω–∞–π-–≤–∞–∂–Ω–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –≤ –∫–æ–º–ø—é—Ç—ä—Ä–Ω–∏—Ç–µ –Ω–∞—É–∫–∏ ‚Äì –ë—ä—Ä–∑–æ—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –Ω–∞ –§—É—Ä–∏–µ (Fast Fourier Transform - FFT).

## 1. –ö–æ–º–ø–ª–µ–∫—Å–Ω–∏ —á–∏—Å–ª–∞ (Complex Numbers)

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∏—Ç–µ —á–∏—Å–ª–∞ —Å–∞ —Ä–∞–∑—à–∏—Ä–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª–Ω–∏—Ç–µ —á–∏—Å–ª–∞. –¢–µ –∏–º–∞—Ç –≤–∏–¥–∞ $z = a + bi$, –∫—ä–¥–µ—Ç–æ:
*   $a$ –µ **—Ä–µ–∞–ª–Ω–∞ —á–∞—Å—Ç** ($	ext{Re}(z)$).
*   $b$ –µ **–∏–º–∞–≥–∏–Ω–µ—Ä–Ω–∞ —á–∞—Å—Ç** ($	ext{Im}(z)$).
*   $i$ –µ –∏–º–∞–≥–∏–Ω–µ—Ä–Ω–∞—Ç–∞ –µ–¥–∏–Ω–∏—Ü–∞, –∑–∞ –∫–æ—è—Ç–æ $i^2 = -1$.

### 1.1. –ê—Ä–∏—Ç–º–µ—Ç–∏—á–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
–ê–∫–æ –∏–º–∞–º–µ –¥–≤–µ —á–∏—Å–ª–∞ $z_1 = a_1 + b_1 i$ –∏ $z_2 = a_2 + b_2 i$:
*   **–°—ä–±–∏—Ä–∞–Ω–µ**: $(a_1 + a_2) + (b_1 + b_2)i$
*   **–ò–∑–≤–∞–∂–¥–∞–Ω–µ**: $(a_1 - a_2) + (b_1 - b_2)i$
*   **–£–º–Ω–æ–∂–µ–Ω–∏–µ**: $(a_1 a_2 - b_1 b_2) + (a_1 b_2 + a_2 b_1)i$ (–∑–∞—â–æ—Ç–æ $i^2 = -1$)

### 1.2. –ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
–í –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—Ç–∞ —Ä–∞–≤–Ω–∏–Ω–∞ (Argand diagram), —á–∏—Å–ª–æ—Ç–æ $z = x + iy$ —Å–µ –ø—Ä–µ–¥—Å—Ç–∞–≤—è –∫–∞—Ç–æ —Ç–æ—á–∫–∞ $(x, y)$.
*   **–ú–æ–¥—É–ª** (–¥—ä–ª–∂–∏–Ω–∞): $|z| = \sqrt{x^2 + y^2}$.
*   **–ê—Ä–≥—É–º–µ–Ω—Ç** (—ä–≥—ä–ª): $\arg(z) = \theta$ –µ —ä–≥—ä–ª—ä—Ç —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª–Ω–∞—Ç–∞ –æ—Å $x$.
*   **–ü–æ–ª—è—Ä–µ–Ω –≤–∏–¥**: $z = r(\cos \theta + i \sin \theta)$, –∫—ä–¥–µ—Ç–æ $r = |z|$.
*   **–§–æ—Ä–º—É–ª–∞ –Ω–∞ –û–π–ª–µ—Ä**: $e^{i\theta} = \cos \theta + i \sin \theta$. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ $z = r e^{i\theta}$.

–£–º–Ω–æ–∂–µ–Ω–∏–µ—Ç–æ –Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏ —á–∏—Å–ª–∞ –≤ –ø–æ–ª—è—Ä–µ–Ω –≤–∏–¥ –µ –º–Ω–æ–≥–æ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ:
$z_1 \cdot z_2 = (r_1 e^{i\theta_1}) (r_2 e^{i\theta_2}) = (r_1 r_2) e^{i(\theta_1 + \theta_2)}$.
*   –ú–æ–¥—É–ª–∏—Ç–µ —Å–µ —É–º–Ω–æ–∂–∞–≤–∞—Ç.
*   –™–≥–ª–∏—Ç–µ —Å–µ —Å—ä–±–∏—Ä–∞—Ç.

### 1.3. C++ `std::complex`
C++ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è –≤–≥—Ä–∞–¥–µ–Ω –∫–ª–∞—Å `<complex>`.

```cpp
#include <iostream>
#include <complex>
#include <cmath>

using namespace std;

typedef complex<double> cd;
const double PI = acos(-1);

int main() {
    cd a(3, 4); // 3 + 4i
    cd b(1, -2); // 1 - 2i
    
    cd sum = a + b;
    cd prod = a * b;
    
    cout << "Sum: " << sum.real() << " + " << sum.imag() << "i\n";
    cout << "Abs of a: " << abs(a) << "\n"; // 5
    cout << "Arg of a: " << arg(a) << "\n"; // –≤ —Ä–∞–¥–∏–∞–Ω–∏
    
    // –°—ä–∑–¥–∞–≤–∞–Ω–µ —á—Ä–µ–∑ –ø–æ–ª—è—Ä–Ω–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏
    cd c = polar(1.0, PI / 2); // 1 * e^(i*pi/2) = i
    cout << "Polar (0, 1): " << c << "\n";
    
    return 0;
}
```

---

## 2. –ü–æ–ª–∏–Ω–æ–º–∏ (Polynomials)

–ü–æ–ª–∏–Ω–æ–º –æ—Ç —Å—Ç–µ–ø–µ–Ω $n-1$ —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –∫–∞—Ç–æ:
$A(x) = a_0 + a_1 x + a_2 x^2 + \dots + a_{n-1} x^{n-1}$

–ò–º–∞ –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω–∏ –Ω–∞—á–∏–Ω–∞ –∑–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤—è–Ω–µ –Ω–∞ –ø–æ–ª–∏–Ω–æ–º:
1.  **–ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–Ω–∞ —Ñ–æ—Ä–º–∞**: –°–ø–∏—Å—ä–∫ —Å –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏—Ç–µ $[a_0, a_1, \dots, a_{n-1}]$.
    *   –°—ä–±–∏—Ä–∞–Ω–µ: $O(n)$.
    *   –£–º–Ω–æ–∂–µ–Ω–∏–µ: $O(n^2)$ (–≤—Å–µ–∫–∏ —Å –≤—Å–µ–∫–∏).
    *   –ü—Ä–µ—Å–º—è—Ç–∞–Ω–µ –Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç (Horner): $O(n)$.
2.  **–¢–æ—á–∫–æ–≤–∞ —Ñ–æ—Ä–º–∞ (Point-Value form)**: –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—Ç $n$ –¥–≤–æ–π–∫–∏ ${\{(x_0, y_0), \dots, (x_{n-1}, y_{n-1})\}}$, –∫—ä–¥–µ—Ç–æ $y_k = A(x_k)$. –í—Å–µ–∫–∏ –ø–æ–ª–∏–Ω–æ–º –æ—Ç —Å—Ç–µ–ø–µ–Ω $n-1$ –µ —É–Ω–∏–∫–∞–ª–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –æ—Ç $n$ —Ç–æ—á–∫–∏.
    *   –°—ä–±–∏—Ä–∞–Ω–µ: $O(n)$ (—Å—ä–±–∏—Ä–∞—Ç —Å–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –∑–∞ –µ–¥–Ω–∏ –∏ —Å—ä—â–∏ $x$).
    *   –£–º–Ω–æ–∂–µ–Ω–∏–µ: $O(n)$ (—É–º–Ω–æ–∂–∞–≤–∞—Ç —Å–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ $C(x_k) = A(x_k) \cdot B(x_k)$)!

**–ò–¥–µ—è—Ç–∞ –Ω–∞ FFT**: –ò—Å–∫–∞–º–µ –¥–∞ —É–º–Ω–æ–∂–∏–º –¥–≤–∞ –ø–æ–ª–∏–Ω–æ–º–∞ –±—ä—Ä–∑–æ.
1.  –ü—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–º–µ –≥–∏ –æ—Ç –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–Ω–∞ –≤ —Ç–æ—á–∫–æ–≤–∞ —Ñ–æ—Ä–º–∞ (**DFT**).
2.  –£–º–Ω–æ–∂–∞–≤–∞–º–µ –≥–∏ –∑–∞ $O(n)$ –≤ —Ç–æ—á–∫–æ–≤–∞ —Ñ–æ—Ä–º–∞.
3.  –í—Ä—ä—â–∞–º–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –≤ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–Ω–∞ —Ñ–æ—Ä–º–∞ (**Inverse DFT**).

–ê–∫–æ –∏–∑–±–µ—Ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª–Ω–∏ $x$, –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–µ—Ç–æ –µ –±–∞–≤–Ω–æ ($O(n^2)$). –ù–æ –∞–∫–æ –∏–∑–±–µ—Ä–µ–º —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ —Ç–æ—á–∫–∏ ‚Äì **–∫–æ–º–ø–ª–µ–∫—Å–Ω–∏—Ç–µ –∫–æ—Ä–µ–Ω–∏ –Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞—Ç–∞**, –º–æ–∂–µ–º –¥–∞ –≥–æ –Ω–∞–ø—Ä–∞–≤–∏–º –∑–∞ $O(n \log n)$.

---

## 3. –ë—ä—Ä–∑–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –Ω–∞ –§—É—Ä–∏–µ (FFT)

### 3.1. –ö–æ—Ä–µ–Ω–∏ –Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞—Ç–∞
–ö–æ–º–ø–ª–µ–∫—Å–Ω–∏—Ç–µ $n$-—Ç–∏ –∫–æ—Ä–µ–Ω–∏ –Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞—Ç–∞ —Å–∞ —Ä–µ—à–µ–Ω–∏—è—Ç–∞ –Ω–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ—Ç–æ $x^n = 1$. –ò–º–∞ —Ç–æ—á–Ω–æ $n$ —Ç–∞–∫–∏–≤–∞ —á–∏—Å–ª–∞, —Ä–∞–∑–ø–æ–ª–æ–∂–µ–Ω–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –≤—ä—Ä—Ö—É –µ–¥–∏–Ω–∏—á–Ω–∞—Ç–∞ –æ–∫—Ä—ä–∂–Ω–æ—Å—Ç.
$\\omega_n^k = e^{i \frac{2\pi k}{n}} = \cos\left(\frac{2\pi k}{n}\right) + i \sin\left(\frac{2\pi k}{n}\right)$

–û—Å–Ω–æ–≤–Ω–∏—è—Ç (–ø—Ä–∏–º–∏—Ç–∏–≤–µ–Ω) –∫–æ—Ä–µ–Ω –µ $\\omega_n = e^{i \frac{2\pi}{n}}$. –û—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ —Å–∞ –Ω–µ–≥–æ–≤–∏ —Å—Ç–µ–ø–µ–Ω–∏: $\\omega_n^0, \\omega_n^1, \dots, \\omega_n^{n-1}$.

–í–∞–∂–Ω–∏ —Å–≤–æ–π—Å—Ç–≤–∞:
1.  $\\omega_n^n = 1$.
2.  $\\omega_n^{n/2} = -1$.
3.  $\\omega_{2n}^{2k} = \\omega_n^k$.

### 3.2. –ê–ª–≥–æ—Ä–∏—Ç—ä–º—ä—Ç –Ω–∞ Cooley-Tukey
–ù–µ–∫–∞ $n$ –µ —á–µ—Ç–Ω–æ —á–∏—Å–ª–æ. –†–∞–∑–¥–µ–ª—è–º–µ –ø–æ–ª–∏–Ω–æ–º–∞ $A(x)$ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏ ‚Äì —á–µ—Ç–Ω–∏ –∏ –Ω–µ—á–µ—Ç–Ω–∏ –∏–Ω–¥–µ–∫—Å–∏:
$A(x) = (a_0 + a_2 x^2 + \dots) + x(a_1 + a_3 x^2 + \dots)$
$A(x) = A_{even}(x^2) + x A_{odd}(x^2)$

–ó–∞ –¥–∞ –ø—Ä–µ—Å–º–µ—Ç–Ω–µ–º $A(x)$ –≤ —Ç–æ—á–∫–∏—Ç–µ $x = \\omega_n^k$, –∑–∞–±–µ–ª—è–∑–≤–∞–º–µ —Å–∏–º–µ—Ç—Ä–∏—è:
–ó–∞ $0 \le k < n/2$:
$x = \\omega_n^k \implies x^2 = \\omega_n^{2k} = \\omega_{n/2}^k$
$A(\omega_n^k) = A_{even}(\\omega_{n/2}^k) + \\omega_n^k A_{odd}(\\omega_{n/2}^k)$

–ó–∞ "–≤—Ç–æ—Ä–∞—Ç–∞ –ø–æ–ª–æ–≤–∏–Ω–∞" $k' = k + n/2$:
$\\omega_n^{k + n/2} = -\\omega_n^k$
$A(\omega_n^{k+n/2}) = A_{even}(\\omega_{n/2}^k) - \\omega_n^k A_{odd}(\\omega_{n/2}^k)$

–¢–∞–∫–∞ –ø—Ä–æ–±–ª–µ–º—ä—Ç –∑–∞ —Ä–∞–∑–º–µ—Ä $n$ —Å–µ —Å–≤–µ–∂–¥–∞ –¥–æ –¥–≤–∞ –ø–æ–¥–ø—Ä–æ–±–ª–µ–º–∞ –∑–∞ —Ä–∞–∑–º–µ—Ä $n/2$.
–°–ª–æ–∂–Ω–æ—Å—Ç: $T(n) = 2T(n/2) + O(n) \implies O(n \log n)$.

### 3.3. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è (–†–µ–∫—É—Ä—Å–∏–≤–Ω–∞)

```cpp
#include <vector>
#include <complex>
#include <cmath>
#include <algorithm>

using namespace std;
typedef complex<double> cd;
const double PI = acos(-1);

void fft(vector<cd> & a, bool invert) {
    int n = a.size();
    if (n == 1) return;

    vector<cd> a0(n / 2), a1(n / 2);
    for (int i = 0; 2 * i < n; i++) {
        a0[i] = a[2 * i];
        a1[i] = a[2 * i + 1];
    }

    fft(a0, invert);
    fft(a1, invert);

    double ang = 2 * PI / n * (invert ? -1 : 1);
    cd w(1), wn(cos(ang), sin(ang));

    for (int i = 0; 2 * i < n; i++) {
        a[i] = a0[i] + w * a1[i];
        a[i + n / 2] = a0[i] - w * a1[i];
        if (invert) {
            a[i] /= 2;
            a[i + n / 2] /= 2;
        }
        w *= wn;
    }
}
```

### 3.4. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è (–û–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω–∞)
–†–µ–∫—É—Ä—Å–∏—è—Ç–∞ –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –±–∞–≤–Ω–∞. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∏—è—Ç –ø–æ–¥—Ö–æ–¥ –∏–∑–ø–æ–ª–∑–≤–∞ "Bit-reversal permutation" ‚Äì –∏–Ω–¥–µ–∫—Å–∏—Ç–µ —Å–µ –ø—Ä–µ–Ω–∞—Ä–µ–∂–¥–∞—Ç —Å–ø–æ—Ä–µ–¥ –æ–≥–ª–µ–¥–∞–ª–Ω–∏—è –∑–∞–ø–∏—Å –Ω–∞ –±–∏—Ç–æ–≤–µ—Ç–µ –∏–º.

```cpp
void fft_iterative(vector<cd> & a, bool invert) {
    int n = a.size();

    // Bit-reversal permutation
    for (int i = 1, j = 0; i < n; i++) {
        int bit = n >> 1;
        for (; j & bit; bit >>= 1)
            j ^= bit;
        j ^= bit;
        if (i < j) swap(a[i], a[j]);
    }

    // Butterfly operations
    for (int len = 2; len <= n; len <<= 1) {
        double ang = 2 * PI / len * (invert ? -1 : 1);
        cd wlen(cos(ang), sin(ang));
        for (int i = 0; i < n; i += len) {
            cd w(1);
            for (int j = 0; j < len / 2; j++) {
                cd u = a[i + j], v = a[i + j + len / 2] * w;
                a[i + j] = u + v;
                a[i + j + len / 2] = u - v;
                w *= wlen;
            }
        }
    }

    if (invert) {
        for (cd & x : a) x /= n;
    }
}
```

### 3.5. –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–∏–Ω–æ–º–∏
–ó–∞ –¥–∞ —É–º–Ω–æ–∂–∏–º –¥–≤–∞ –ø–æ–ª–∏–Ω–æ–º–∞ $A$ –∏ $B$:
1.  –†–∞–∑—à–∏—Ä—è–≤–∞–º–µ –≤–µ–∫—Ç–æ—Ä–∏—Ç–µ —Å –Ω—É–ª–∏ –¥–æ –Ω–∞–π-–±–ª–∏–∑–∫–∞—Ç–∞ —Å—Ç–µ–ø–µ–Ω –Ω–∞ 2, –∫–æ—è—Ç–æ –µ –ø–æ–Ω–µ $\deg(A) + \deg(B) + 1$.
2.  –ü—Ä–∏–ª–∞–≥–∞–º–µ FFT –≤—ä—Ä—Ö—É $A$ –∏ $B$.
3.  –£–º–Ω–æ–∂–∞–≤–∞–º–µ –ø–æ–µ–ª–µ–º–µ–Ω—Ç–Ω–æ $A[i] = A[i] \cdot B[i]$.
4.  –ü—Ä–∏–ª–∞–≥–∞–º–µ Inverse FFT –≤—ä—Ä—Ö—É —Ä–µ–∑—É–ª—Ç–∞—Ç–∞.
5.  (–û–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ) –ó–∞–∫—Ä—ä–≥–ª—è–º–µ —Ä–µ–∞–ª–Ω–∏—Ç–µ —á–∞—Å—Ç–∏ –∫—ä–º –Ω–∞–π-–±–ª–∏–∑–∫–æ—Ç–æ —Ü—è–ª–æ —á–∏—Å–ª–æ.

```cpp
vector<int> multiply(vector<int> const& a, vector<int> const& b) {
    vector<cd> fa(a.begin(), a.end()), fb(b.begin(), b.end());
    int n = 1;
    while (n < a.size() + b.size()) 
        n <<= 1;
    fa.resize(n);
    fb.resize(n);

    fft_iterative(fa, false);
    fft_iterative(fb, false);

    for (int i = 0; i < n; i++)
        fa[i] *= fb[i];

    fft_iterative(fa, true);

    vector<int> result(n);
    for (int i = 0; i < n; i++)
        result[i] = round(fa[i].real());
    
    // –ü—Ä–µ–º–∞—Ö–≤–∞–Ω–µ –Ω–∞ –≤–æ–¥–µ—â–∏ –Ω—É–ª–∏ –∞–∫–æ –µ –Ω—É–∂–Ω–æ
    return result;
}
```

---

## 4. Number Theoretic Transform (NTT)

FFT –∏–∑–ø–æ–ª–∑–≤–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏ —á–∏—Å–ª–∞ (`double`), –∫–æ–µ—Ç–æ –≤–æ–¥–∏ –¥–æ –≥—Ä–µ—à–∫–∏ –æ—Ç –∑–∞–∫—Ä—ä–≥–ª—è–Ω–µ. –ü—Ä–∏ –∑–∞–¥–∞—á–∏, –∏–∑–∏—Å–∫–≤–∞—â–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç –ø–æ –º–æ–¥—É–ª, –∏–∑–ø–æ–ª–∑–≤–∞–º–µ **NTT**.
–¢–æ–≤–∞ –µ –µ–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—ä—Ç –Ω–∞ FFT –≤ –∫—Ä–∞–π–Ω–∏ –ø–æ–ª–µ—Ç–∞ (Modular Arithmetic).
*   –í–º–µ—Å—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏ –∫–æ—Ä–µ–Ω–∏ –Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞—Ç–∞, –∏–∑–ø–æ–ª–∑–≤–∞–º–µ **–ø—Ä–∏–º–∏—Ç–∏–≤–Ω–∏ –∫–æ—Ä–µ–Ω–∏** –ø–æ –º–æ–¥—É–ª $P$.
*   –ò–∑–∏—Å–∫–≤–∞ $P$ –¥–∞ –µ –æ—Ç —Å–ø–µ—Ü–∏–∞–ª–µ–Ω –≤–∏–¥: $P = c \cdot 2^k + 1$.
*   –ü—Ä–∏–º–µ—Ä: $998244353 = 119 \cdot 2^{23} + 1$. –ü—Ä–∏–º–∏—Ç–∏–≤–µ–Ω –∫–æ—Ä–µ–Ω $g=3$.

**–ü—Ä–µ–¥–∏–º—Å—Ç–≤–æ**: –†–∞–±–æ—Ç–∏ —Å —Ü–µ–ª–∏ —á–∏—Å–ª–∞ (`long long`), –Ω—è–º–∞ –∑–∞–≥—É–±–∞ –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç.

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ NTT
–í—Å–∏—á–∫–æ –µ —Å—ä—â–æ—Ç–æ –∫–∞—Ç–æ FFT, –Ω–æ:
1.  –í—Å–∏—á–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–∞ –ø–æ –º–æ–¥—É–ª $P$.
2.  $\\omega_n$ —Å–µ –∑–∞–º–µ–Ω—è —Å $g^{(P-1)/n} \pmod P$.
3.  $\\omega_n^{-1}$ —Å–µ –∑–∞–º–µ–Ω—è —Å –º–æ–¥—É–ª—è—Ä–Ω–æ—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ.

```cpp
const int mod = 998244353;
const int root = 3; // –ü—Ä–∏–º–∏—Ç–∏–≤–µ–Ω –∫–æ—Ä–µ–Ω
// –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞ –∏–∑–∏—Å–∫–≤–∞ –º–æ–¥—É–ª–Ω–æ —Å—Ç–µ–ø–µ–Ω—É–≤–∞–Ω–µ –∏ –º–æ–¥—É–ª–Ω–æ –æ–±—Ä–∞—Ç–Ω–æ
```

---

## 5. Fast Walsh-Hadamard Transform (FWHT)

FWHT –µ –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ FFT, –∫–æ–π—Ç–æ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∏—Ç–æ–≤–∏ –º–∞—Å–∫–∏. –ê–∫–æ –∏—Å–∫–∞–º–µ –¥–∞ –Ω–∞–º–µ—Ä–∏–º –ø–æ–ª–∏–Ω–æ–º $C$, —Ç–∞–∫—ä–≤ —á–µ:
$C[k] = \sum_{i \oplus j = k} A[i] B[j]$ (XOR –∫–æ–Ω–≤–æ–ª—é—Ü–∏—è)
–ò–ª–∏ –∑–∞ AND/OR –æ–ø–µ—Ä–∞—Ü–∏–∏.

–ü—Ä–∏ XOR FWHT –º–∞—Ç—Ä–∏—Ü–∞—Ç–∞ –Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –µ –º–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç–∞:
$\begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix}$
–¢–æ–≤–∞ –ø–æ–∑–≤–æ–ª—è–≤–∞ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∑–∞ $O(N \log N)$ –≤–º–µ—Å—Ç–æ $O(N^2)$.

---

## 6. –ó–∞–¥–∞—á–∏ –∑–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
1.  **SPOJ POLARIVAL**: –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –Ω–∞ –ø–æ–ª–∏–Ω–æ–º.
2.  **SPOJ MUL**: –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –≥–æ–ª–µ–º–∏ —á–∏—Å–ª–∞ (—Ä–∞–∑–≥–ª–µ–∂–¥–∞–º–µ —Ü–∏—Ñ—Ä–∏—Ç–µ –∫–∞—Ç–æ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏).
3.  **Codeforces 993E**: Nikita and Order Statistics (–±—Ä–æ–µ–Ω–µ –Ω–∞ –ø–æ–¥–º–∞—Å–∏–≤–∏).
4.  **CSES Problem Set**: Polynomial Queries.

FFT –µ –º–æ—â–µ–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–µ —Å–∞–º–æ –∑–∞ –ø–æ–ª–∏–Ω–æ–º–∏, –Ω–æ –∏ –∑–∞ –≤—Å—è–∫–∞–∫–≤–∏ –∑–∞–¥–∞—á–∏, –≤–∫–ª—é—á–≤–∞—â–∏ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–∏–∫–∞ –∏ —Å—É–º–∏ —Å —Ñ–∏–∫—Å–∏—Ä–∞–Ω –∏–Ω–¥–µ–∫—Å (–∫–æ–Ω–≤–æ–ª—é—Ü–∏–∏).

```

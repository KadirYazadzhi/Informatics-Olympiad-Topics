# üß† –ù–∞–ø—Ä–µ–¥–Ω–∞–ª–æ –î–∏–Ω–∞–º–∏—á–Ω–æ –ü—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ (Advanced DP)

–°–ª–µ–¥ –∫–∞—Ç–æ –æ–≤–ª–∞–¥–µ–µ—Ç–µ –∫–ª–∞—Å–∏—á–µ—Å–∫–æ—Ç–æ DP (–†–∞–Ω–∏—Ü–∞, LIS, LCS), —Å–ª–µ–¥–≤–∞—â–æ—Ç–æ –Ω–∏–≤–æ –≤–∫–ª—é—á–≤–∞ —Ç–µ—Ö–Ω–∏–∫–∏ –∑–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏—è—Ç–∞ –∏ –ø—Ä–µ—Ö–æ–¥–∏—Ç–µ.

## 1. –î–ü –≤—ä—Ä—Ö—É –î—ä—Ä–≤–æ (Tree DP)

–ó–∞–¥–∞—á–∏—Ç–µ –≤—ä—Ä—Ö—É –¥—ä—Ä–≤–µ—Ç–∞ —á–µ—Å—Ç–æ —Å–µ —Ä–µ—à–∞–≤–∞—Ç —Å DFS, –∫–∞—Ç–æ –∑–∞ –≤—Å–µ–∫–∏ –≤—Ä—ä—Ö $u$ –∏–∑—á–∏—Å–ª—è–≤–∞–º–µ $dp[u]$ –Ω–∞ –±–∞–∑–∞—Ç–∞ –Ω–∞ –¥–µ—Ü–∞—Ç–∞ –º—É.

### 1.1. –ö–ª–∞—Å–∏—á–µ—Å–∫–æ Tree DP
–ü—Ä–∏–º–µ—Ä: –ú–∞–∫—Å–∏–º–∞–ª–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ (Maximum Independent Set) –≤ –¥—ä—Ä–≤–æ.
$dp[u][0]$: $u$ –Ω–µ –µ –∏–∑–±—Ä–∞–Ω. –î–µ—Ü–∞—Ç–∞ –º–æ–≥–∞—Ç –¥–∞ —Å–∞ –∏–ª–∏ –¥–∞ –Ω–µ —Å–∞.
$dp[u][1]$: $u$ –µ –∏–∑–±—Ä–∞–Ω. –î–µ—Ü–∞—Ç–∞ –Ω–µ –º–æ–≥–∞—Ç –¥–∞ —Å–∞.

### 1.2. Rerooting Technique (–î–ü —Å –≤—Å–∏—á–∫–∏ –∫–æ—Ä–µ–Ω–∏)
–ê–∫–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –Ω–∞–º–µ—Ä–∏–º –æ—Ç–≥–æ–≤–æ—Ä–∞ –∑–∞ *–≤—Å–µ–∫–∏* –≤—Ä—ä—Ö, –∞–∫–æ —Ç–æ–π –±–µ—à–µ –∫–æ—Ä–µ–Ω.
1.  –ü—Ä–µ—Å–º—è—Ç–∞–º–µ DP –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–ª–µ–Ω –∫–æ—Ä–µ–Ω (–Ω–∞–ø—Ä. 1) —Å DFS (Bottom-up).
2.  –ü—É—Å–Ω–µ–º –≤—Ç–æ—Ä–∏ DFS (Top-down), –∫–æ–π—Ç–æ –ø—Ä–µ—Ö–≤—ä—Ä–ª—è —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è –∫—ä–º –¥–µ—Ç–µ—Ç–æ, "–ø—Ä–µ–º–µ—Å—Ç–≤–∞–π–∫–∏" –∫–æ—Ä–µ–Ω–∞.

## 2. –î–ü –≤—ä—Ä—Ö—É –ü—Ä–æ—Ñ–∏–ª (Broken Profile DP)

–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –∑–∞ –ø–æ–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ –º—Ä–µ–∂–∏ $N \times M$ —Å —Ñ–∏–≥—É—Ä–∏ (–¥–æ–º–∏–Ω–æ, –ø–ª–æ—á–∫–∏), –∫—ä–¥–µ—Ç–æ $N$ –µ –º–∞–ª–∫–æ.
–°—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –µ –±–∏—Ç–æ–≤–∞ –º–∞—Å–∫–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–≤–∞—â–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ç–∞ ("–ø—Ä–æ—Ñ–∏–ª–∞") –º–µ–∂–¥—É –æ–±—Ä–∞–±–æ—Ç–µ–Ω–∞—Ç–∞ –∏ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–µ–Ω–∞—Ç–∞ —á–∞—Å—Ç.
–°–ª–æ–∂–Ω–æ—Å—Ç: $O(N \cdot M \cdot 2^N)$.

## 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–µ—Ö–æ–¥–∏—Ç–µ

–ú–Ω–æ–≥–æ DP –∑–∞–¥–∞—á–∏ –∏–º–∞—Ç —Ñ–æ—Ä–º—É–ª–∞ –æ—Ç –≤–∏–¥–∞:
$dp[i] = \min_{j < i} \{ dp[j] + cost(j, i) \}$
–î–∏—Ä–µ–∫—Ç–Ω–æ—Ç–æ –ø—Ä–µ—Å–º—è—Ç–∞–Ω–µ –µ $O(N^2)$. –¶–µ–ª—Ç–∞ –µ –¥–∞ –≥–æ —Å–≤–µ–¥–µ–º –¥–æ $O(N \log N)$ –∏–ª–∏ $O(N)$.

### 3.1. Convex Hull Trick (CHT)
–ê–∫–æ $cost(j, i)$ –∏–º–∞ –≤–∏–¥ –Ω–∞ –ª–∏–Ω–µ–π–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è $m_j \cdot x_i + c_j$ (–Ω–∞–ø—Ä. $b_j \cdot a_i$).
–í—Å—è–∫–æ $j$ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –ø—Ä–∞–≤–∞ $y = m_j x + c_j$. –¢—ä—Ä—Å–∏–º –º–∏–Ω–∏–º—É–º –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏ –∑–∞ –¥–∞–¥–µ–Ω–æ $x_i$.
*   –ü–æ–¥–¥—ä—Ä–∂–∞–º–µ –¥–æ–ª–Ω–∞—Ç–∞ –∏–∑–ø—ä–∫–Ω–∞–ª–∞ –æ–±–≤–∏–≤–∫–∞ –Ω–∞ –ø—Ä–∞–≤–∏—Ç–µ.
*   –ê–∫–æ –Ω–∞–∫–ª–æ–Ω–∏—Ç–µ —Å–∞ –º–æ–Ω–æ—Ç–æ–Ω–Ω–∏: $O(N)$ —Å Deque.
*   –ê–∫–æ –Ω–µ —Å–∞: $O(N \log N)$ —Å Li Chao Tree –∏–ª–∏ `std::set`.

### 3.2. Divide and Conquer Optimization
–ü—Ä–∏–ª–æ–∂–∏–º–æ, –∞–∫–æ $dp[i][k] = \min_{j < i} \{ dp[j][k-1] + cost(j, i) \}$ –∏ –æ–ø—Ç–∏–º–∞–ª–Ω–æ—Ç–æ $opt[i][k]$ –µ –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ ($opt[i] \le opt[i+1]$).
–í–º–µ—Å—Ç–æ –¥–∞ —Ç—ä—Ä—Å–∏–º $j$ –∑–∞ –≤—Å—è–∫–æ $i$, –ø—Ä–µ—Å–º—è—Ç–∞–º–µ –∑–∞ $mid$, –Ω–∞–º–∏—Ä–∞–º–µ $opt[mid]$ –∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∞–≤–∞–º–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –Ω–∞ —Ç—ä—Ä—Å–µ–Ω–µ –∑–∞ –ª—è–≤–∞—Ç–∞ –∏ –¥—è—Å–Ω–∞—Ç–∞ –ø–æ–ª–æ–≤–∏–Ω–∞.
–°–ª–æ–∂–Ω–æ—Å—Ç: $O(K \cdot N \log N)$.

### 3.3. Knuth Optimization
–ü–æ–¥–æ–±–Ω–æ –Ω–∞ D&C, –Ω–æ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–Ω–∏ –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä. Optimal Binary Search Tree).
–£—Å–ª–æ–≤–∏–µ: $opt[i][j-1] \le opt[i][j] \le opt[i+1][j]$.
–°–ª–æ–∂–Ω–æ—Å—Ç: $O(N^2)$ –≤–º–µ—Å—Ç–æ $O(N^3)$.

## 4. SOS DP (Sum Over Subsets)
–ó–∞ –ø—Ä–µ—Å–º—è—Ç–∞–Ω–µ –Ω–∞ $F[mask] = \sum_{sub \subseteq mask} A[sub]$.
–ù–∞–∏–≤–Ω–æ: $O(3^N)$.
SOS DP: $O(N \cdot 2^N)$.

```cpp
for (int i = 0; i < N; ++i) {
    for (int mask = 0; mask < (1<<N); ++mask) {
        if (mask & (1<<i))
            dp[mask] += dp[mask ^ (1<<i)];
    }
}
```

## 5. –ó–∞–¥–∞—á–∏
1.  **CSES Tree Distances I & II**: Rerooting.
2.  **Codeforces 319C**: Kalila and Dimna (Convex Hull Trick).
3.  **SPOJ MDOLLS**: Dilworth's Theorem / DP with Data Structures.

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
Advanced DP –µ –∏–∑–∫—É—Å—Ç–≤–æ—Ç–æ –¥–∞ –ø—Ä–µ–≤—ä—Ä–Ω–µ—à "–Ω–µ–≤—ä–∑–º–æ–∂–Ω–æ—Ç–æ" $O(N^2)$ —Ä–µ—à–µ–Ω–∏–µ –≤ $O(N)$ —á—Ä–µ–∑ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è.

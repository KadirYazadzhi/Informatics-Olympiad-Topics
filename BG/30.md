# üîë –•–µ—à–∏—Ä–∞–Ω–µ: –ï–∫—Å–ø–µ—Ä—Ç–Ω–∏ —Ç–µ—Ö–Ω–∏–∫–∏

## üîÑ –ú–∏–Ω–∏–º–∞–ª–µ–Ω —Ü–∏–∫–ª–∏—á–µ–Ω —à–∏—Ñ—Ç (Minimal Cyclic Shift)

–î–∞–¥–µ–Ω –µ –Ω–∏–∑ $S$. –ù–∞–º–µ—Ä–µ—Ç–µ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ—Å–∫–∏ –Ω–∞–π-–º–∞–ª–∫–∏—è –Ω–∏–∑, –∫–æ–π—Ç–æ –º–æ–∂–µ –¥–∞ —Å–µ –ø–æ–ª—É—á–∏ —á—Ä–µ–∑ —Ü–∏–∫–ª–∏—á–Ω–∏ –ø—Ä–µ–º–µ—Å—Ç–≤–∞–Ω–∏—è –Ω–∞ $S$.
- **–ü–æ–¥—Ö–æ–¥ —Å —Ö–µ—à–∏—Ä–∞–Ω–µ**:
  1. –†–∞–∑–≥–ª–µ–∂–¥–∞–º–µ –Ω–∏–∑–∞ $S+S$.
  2. –í—Å–µ–∫–∏ —Ü–∏–∫–ª–∏—á–µ–Ω —à–∏—Ñ—Ç –Ω–∞ $S$ —Å –¥—ä–ª–∂–∏–Ω–∞ $N$ –µ –ø–æ–¥–Ω–∏–∑ –Ω–∞ $S+S$ —Å –¥—ä–ª–∂–∏–Ω–∞ $N$.
  3. –¢—ä—Ä—Å–∏–º –∏–Ω–¥–µ–∫—Å–∞ $i \in [0, N-1]$, –∑–∞ –∫–æ–π—Ç–æ –ø–æ–¥–Ω–∏–∑—ä—Ç $S[i \dots i+N-1]$ –µ –º–∏–Ω–∏–º–∞–ª–µ–Ω.
  4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ—Ç–æ –Ω–∞ –¥–≤–∞ –ø–æ–¥–Ω–∏–∑–∞ —Å—Ç–∞–≤–∞ —á—Ä–µ–∑ –¥–≤–æ–∏—á–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ –ø–æ –¥—ä–ª–∂–∏–Ω–∞—Ç–∞ –Ω–∞ –æ–±—â–∏—è –∏–º –ø—Ä–µ—Ñ–∏–∫—Å (LCP) + —Ö–µ—à–∏—Ä–∞–Ω–µ. LCP –Ω–∞–º–∏—Ä–∞–º–µ –∑–∞ $O(\log N)$, –∞ —Å–ª–µ–¥–≤–∞—â–∏—è—Ç —Å–∏–º–≤–æ–ª –æ–ø—Ä–µ–¥–µ–ª—è —Ä–µ–¥–∞.
  5. –û–±—â–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç: $O(N \log^2 N)$ –∏–ª–∏ $O(N \log N)$ (–∑–∞—â–æ—Ç–æ –ø—Ä–∞–≤–∏–º $N$ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–º–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ –º–∏–Ω–∏–º—É–º–∞).

---

## üå≥ –ö–∞–Ω–æ–Ω–∏—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤—è–Ω–µ –Ω–∞ –¥—ä—Ä–≤–µ—Ç–∞ (Tree Hashing)

–ö–∞–∫ –¥–∞ –ø—Ä–æ–≤–µ—Ä–∏–º –¥–∞–ª–∏ –¥–≤–µ –Ω–µ-–∫–æ—Ä–µ–Ω–Ω–∏ –¥—ä—Ä–≤–µ—Ç–∞ —Å–∞ –∏–∑–æ–º–æ—Ä—Ñ–Ω–∏?
1. **–ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ —Ü–µ–Ω—Ç—ä—Ä–∞**: –î—ä—Ä–≤–æ—Ç–æ –∏–º–∞ 1 –∏–ª–∏ 2 —Ü–µ–Ω—Ç—ä—Ä–∞. –¢–æ–≤–∞ –Ω–∏ –¥–∞–≤–∞ –∫–æ—Ä–µ–Ω(–∏) –∑–∞ –∫–∞–Ω–æ–Ω–∏–∑–∞—Ü–∏—è.
2. **–•–µ—à–∏—Ä–∞–Ω–µ –Ω–∞ –ø–æ–¥–¥—ä—Ä–≤–µ—Ç–∞**:
   - –ó–∞ –≤—Å–µ–∫–∏ –ª–∏—Å—Ç —Ö–µ—à—ä—Ç –µ `()` (–∏–ª–∏ —Ñ–∏–∫—Å–∏—Ä–∞–Ω–æ —á–∏—Å–ª–æ).
   - –ó–∞ –≤—ä—Ç—Ä–µ—à–µ–Ω –≤—ä–∑–µ–ª: –°–æ—Ä—Ç–∏—Ä–∞–º–µ —Ö–µ—à–æ–≤–µ—Ç–µ –Ω–∞ –¥–µ—Ü–∞—Ç–∞ –º—É, –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–∞–º–µ –≥–∏ –∏ –≥–∏ –æ–≥—Ä–∞–∂–¥–∞–º–µ —Å—ä—Å —Å–∫–æ–±–∏.
   - $H(u) = "(" + \text{sort}(H(v_1), H(v_2), \dots) + ")"$.
   - –í–º–µ—Å—Ç–æ –Ω–∏–∑–æ–≤–µ, –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –ø–æ–ª–∏–Ω–æ–º–Ω–∏ —Ö–µ—à–æ–≤–µ –≤—ä—Ä—Ö—É —Å–æ—Ä—Ç–∏—Ä–∞–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–∞ –¥–µ—Ü–∞—Ç–∞.
   
   $$H(u) = \left( \sum_{v \in children(u)} P(H(v)) \right) \pmod M$$
   *–í–Ω–∏–º–∞–Ω–∏–µ*: –ü—Ä–æ—Å—Ç–∞—Ç–∞ —Å—É–º–∞ –µ –∫–æ–º—É—Ç–∞—Ç–∏–≤–Ω–∞, –Ω–æ –º–æ–∂–µ –¥–∞ –¥–æ–≤–µ–¥–µ –¥–æ –∫–æ–ª–∏–∑–∏–∏ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏. –ü–æ-–¥–æ–±—Ä–µ –µ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ —Å–ª–æ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞ —Å–º–µ—Å–≤–∞–Ω–µ.

---

## üé≤ –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–∞–Ω–æ —Ö–µ—à–∏—Ä–∞–Ω–µ

–ó–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ–º "killer tests" –≤ Codeforces (–∫–æ–∏—Ç–æ —Å–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏ —Å–ø–µ—Ü–∏–∞–ª–Ω–æ, –∑–∞ –¥–∞ —á—É–ø—è—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏ –º–æ–¥—É–ª–∏ –∫–∞—Ç–æ $10^9+7$):
1. –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ **–¥–≤–∞ –º–æ–¥—É–ª–∞**.
2. –ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ –±–∞–∑–∞—Ç–∞ $P$ –Ω–∞ —Å–ª—É—á–∞–µ–Ω –ø—Ä–∏–Ω—Ü–∏–ø –≤ –Ω–∞—á–∞–ª–æ—Ç–æ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞—Ç–∞.
   ```cpp
   mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());
   int P = uniform_int_distribution<int>(300, 10000)(rng);
   ```

---

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–•–µ—à–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ –¥—ä—Ä–≤–µ—Ç–∞ –µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω —Ç—Ä–∏–∫ –∑–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∏–∑–æ–º–æ—Ä—Ñ–∏–∑—ä–º. –ü—Ä–∏ –Ω–∏–∑–æ–≤–µ—Ç–µ, —Ö–µ—à–∏—Ä–∞–Ω–µ—Ç–æ —á–µ—Å—Ç–æ –µ –ø–æ-–ª–µ—Å–Ω–∞ (–º–∞–∫–∞—Ä –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∞) –∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –Ω–∞ KMP –∏–ª–∏ Suffix Array. –í–∏–Ω–∞–≥–∏ –ø–æ–º–Ω–µ—Ç–µ –¥–≤–æ–π–Ω–æ—Ç–æ —Ö–µ—à–∏—Ä–∞–Ω–µ!
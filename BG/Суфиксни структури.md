# üî§ –°—É—Ñ–∏–∫—Å–µ–Ω –∞–≤—Ç–æ–º–∞—Ç (Suffix Automaton - SAM)

## ‚öôÔ∏è –ü–æ—Å—Ç—Ä–æ—è–≤–∞–Ω–µ –∏ –°–≤–æ–π—Å—Ç–≤–∞

SAM –µ DAG, –∫—ä–¥–µ—Ç–æ –≤—ä–∑–ª–∏—Ç–µ —Å–∞ –∫–ª–∞—Å–æ–≤–µ –Ω–∞ –µ–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç –Ω–∞ –ø–æ–¥–Ω–∏–∑–æ–≤–µ (—Å–ø–æ—Ä–µ–¥ —Ç–µ—Ö–Ω–∏—Ç–µ `endpos` –º–Ω–æ–∂–µ—Å—Ç–≤–∞), –∞ —Ä–µ–±—Ä–∞—Ç–∞ —Å–∞ –ø—Ä–µ—Ö–æ–¥–∏ —Å—ä—Å —Å–∏–º–≤–æ–ª–∏.
- –í—Å–µ–∫–∏ –≤—ä–∑–µ–ª –∏–º–∞ `len` (–¥—ä–ª–∂–∏–Ω–∞ –Ω–∞ –Ω–∞–π-–¥—ä–ª–≥–∏—è –ø–æ–¥–Ω–∏–∑ –≤ –∫–ª–∞—Å–∞) –∏ `link` (—Å—É—Ñ–∏–∫—Å–Ω–∞ –≤—Ä—ä–∑–∫–∞ –∫—ä–º –∫–ª–∞—Å–∞ –Ω–∞ –Ω–∞–π-–¥—ä–ª–≥–∏—è —Å—É—Ñ–∏–∫—Å, –∫–æ–π—Ç–æ –µ –≤ –¥—Ä—É–≥ –∫–ª–∞—Å).

**–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª–Ω–æ –ø–æ—Å—Ç—Ä–æ—è–≤–∞–Ω–µ**:
1. –ò–º–∞–º–µ `last` (–≤—ä–∑–µ–ª–∞ –∑–∞ —Ü–µ–ª–∏—è —Ç–µ–∫—É—â –Ω–∏–∑). –°—ä–∑–¥–∞–≤–∞–º–µ `cur` —Å `len = len(last) + 1`.
2. –í—ä—Ä–≤–∏–º –ø–æ `link` –æ—Ç `last` –Ω–∞–∑–∞–¥. –ê–∫–æ –Ω—è–º–∞—Ç –ø—Ä–µ—Ö–æ–¥ —Å –Ω–æ–≤–∏—è —Å–∏–º–≤–æ–ª $c$, –¥–æ–±–∞–≤—è–º–µ –∫—ä–º `cur`.
3. –ê–∫–æ —Å—Ç–∏–≥–Ω–µ–º –≤—ä–∑–µ–ª $p$, –∫–æ–π—Ç–æ –∏–º–∞ –ø—Ä–µ—Ö–æ–¥ $q$ —Å $c$:
   - –ê–∫–æ $len(p) + 1 == len(q)$, —Ç–æ `link(cur) = q`.
   - –ò–Ω–∞—á–µ –∫–ª–æ–Ω–∏—Ä–∞–º–µ $q$ –≤ $clone$ (—Å `len = len(p) + 1`) –∏ –ø—Ä–µ–Ω–∞—Å–æ—á–≤–∞–º–µ –≤—Ä—ä–∑–∫–∏—Ç–µ.

**–°–ª–æ–∂–Ω–æ—Å—Ç**: $O(N)$ –≤—Ä–µ–º–µ –∏ $O(N \Sigma)$ –ø–∞–º–µ—Ç (–∏–ª–∏ $O(N)$ —Å map).

## üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. **–ë—Ä–æ–π —Ä–∞–∑–ª–∏—á–Ω–∏ –ø–æ–¥–Ω–∏–∑–æ–≤–µ**: $\sum (len(u) - len(link(u)))$.
2. **–ù–∞–π-–¥—ä–ª—ä–≥ –æ–±—â –ø–æ–¥–Ω–∏–∑ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–∏–∑–æ–≤–µ**: –ü—Ä–æ–∫–∞—Ä–≤–∞–º–µ –Ω–∏–∑–æ–≤–µ—Ç–µ –ø—Ä–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∞ –∏ –ø–∞–∑–∏–º —Ç–µ–∫—É—â–∞—Ç–∞ –¥—ä–ª–∂–∏–Ω–∞.
3. **K-—Ç–∏ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ—Å–∫–∏ –ø–æ–¥–Ω–∏–∑**: –ë—Ä–æ–∏–º –ø—ä—Ç–∏—â–∞—Ç–∞ –≤ DAG-–∞.

---

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

SAM –µ –Ω–∞–π-–º–æ—â–Ω–∞—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞ –Ω–∏–∑–æ–≤–µ. –ö–æ–¥—ä—Ç –µ –∫—Ä–∞—Ç—ä–∫ (~30 —Ä–µ–¥–∞), –Ω–æ –ª–æ–≥–∏–∫–∞—Ç–∞ –µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∞. –ù–∞—É—á–µ—Ç–µ –≥–æ –Ω–∞–∏–∑—É—Å—Ç.
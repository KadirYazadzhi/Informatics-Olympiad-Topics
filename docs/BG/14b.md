# üîç –î–≤–æ–∏—á–Ω–æ –¢—ä—Ä—Å–µ–Ω–µ (Binary Search)

–î–≤–æ–∏—á–Ω–æ—Ç–æ —Ç—ä—Ä—Å–µ–Ω–µ –µ –µ–¥–∏–Ω –æ—Ç –Ω–∞–π-—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª–Ω–∏—Ç–µ –∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏. –¢–æ –ø–æ–∑–≤–æ–ª—è–≤–∞ –Ω–∞–º–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç –≤ **—Å–æ—Ä—Ç–∏—Ä–∞–Ω** –º–∞—Å–∏–≤ –∑–∞ –ª–æ–≥–∞—Ä–∏—Ç–º–∏—á–Ω–æ –≤—Ä–µ–º–µ $O(\log N)$, –≤–º–µ—Å—Ç–æ –ª–∏–Ω–µ–π–Ω–æ $O(N)$.

## 1. –ö–ª–∞—Å–∏—á–µ—Å–∫–∏ –ê–ª–≥–æ—Ä–∏—Ç—ä–º

–ò–¥–µ—è—Ç–∞ –µ –¥–∞ –ø–æ–¥–¥—ä—Ä–∂–∞–º–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª `[L, R]`, –≤ –∫–æ–π—Ç–æ —Ç—ä—Ä—Å–µ–Ω–∏—è—Ç –µ–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ –¥–∞ —Å–µ –Ω–∞–º–∏—Ä–∞. –ù–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–≤–∞–º–µ —Å—Ä–µ–¥–∞—Ç–∞ `mid`.
*   –ê–∫–æ `arr[mid] == target`, –Ω–∞–º–µ—Ä–∏–ª–∏ —Å–º–µ –≥–æ.
*   –ê–∫–æ `arr[mid] < target`, —Ç—ä—Ä—Å–∏–º –≤ –¥—è—Å–Ω–∞—Ç–∞ –ø–æ–ª–æ–≤–∏–Ω–∞ `[mid + 1, R]`.
*   –ê–∫–æ `arr[mid] > target`, —Ç—ä—Ä—Å–∏–º –≤ –ª—è–≤–∞—Ç–∞ –ø–æ–ª–æ–≤–∏–Ω–∞ `[L, mid - 1]`.

```cpp
int binarySearch(const vector<int>& arr, int target) {
    int l = 0, r = arr.size() - 1;
    while (l <= r) {
        int mid = l + (r - l) / 2; // –ü—Ä–µ–¥–ø–∞–∑–≤–∞ –æ—Ç overflow –ø—Ä–∏ (l+r)
        if (arr[mid] == target) return mid;
        if (arr[mid] < target) l = mid + 1;
        else r = mid - 1;
    }
    return -1; // –ù–µ –µ –Ω–∞–º–µ—Ä–µ–Ω
}
```

## 2. STL –§—É–Ω–∫—Ü–∏–∏ (`lower_bound` / `upper_bound`)

–í C++ —Ä—è–¥–∫–æ –ø–∏—à–µ–º —á–∏—Å—Ç binary search, –æ—Å–≤–µ–Ω –∞–∫–æ —É—Å–ª–æ–≤–∏–µ—Ç–æ –Ω–µ –µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ç–∞ `<algorithm>` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è:

*   **`lower_bound(begin, end, val)`**: –í—Ä—ä—â–∞ –∏—Ç–µ—Ä–∞—Ç–æ—Ä –∫—ä–º **–ø—ä—Ä–≤–∏—è** –µ–ª–µ–º–µ–Ω—Ç, –∫–æ–π—Ç–æ –µ $\ge val$.
*   **`upper_bound(begin, end, val)`**: –í—Ä—ä—â–∞ –∏—Ç–µ—Ä–∞—Ç–æ—Ä –∫—ä–º **–ø—ä—Ä–≤–∏—è** –µ–ª–µ–º–µ–Ω—Ç, –∫–æ–π—Ç–æ –µ $> val$.

```cpp
vector<int> v = {10, 20, 20, 20, 30};

// –ü—ä—Ä–≤–æ—Ç–æ 20
auto lb = lower_bound(v.begin(), v.end(), 20); 
cout << (lb - v.begin()); // –ò–Ω–¥–µ–∫—Å 1

// –ü—ä—Ä–≤–æ—Ç–æ > 20 (—Ç.–µ. 30)
auto ub = upper_bound(v.begin(), v.end(), 20); 
cout << (ub - v.begin()); // –ò–Ω–¥–µ–∫—Å 4

// –ë—Ä–æ–π —Å—Ä–µ—â–∞–Ω–∏—è –Ω–∞ 20
cout << (ub - lb); // 3
```

## 3. –î–≤–æ–∏—á–Ω–æ –¢—ä—Ä—Å–µ–Ω–µ –ø–æ –û—Ç–≥–æ–≤–æ—Ä (Binary Search on Answer)

–¢–æ–≤–∞ –µ –Ω–∞–π-–º–æ—â–Ω–æ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç—ä–º–∞ –≤ —Å—ä—Å—Ç–µ–∑–∞–Ω–∏—è. –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ, –∫–æ–≥–∞—Ç–æ —Ç—ä—Ä—Å–∏–º "–º–∏–Ω–∏–º–∞–ª–Ω–∞—Ç–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç $X$, –∑–∞ –∫–æ—è—Ç–æ –µ –≤—ä–∑–º–æ–∂–Ω–æ –¥–∞ –∏–∑–ø—ä–ª–Ω–∏–º —É—Å–ª–æ–≤–∏–µ $P(X)$" (–∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞—Ç–∞).
–§—É–Ω–∫—Ü–∏—è—Ç–∞ $P(X)$ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –º–æ–Ω–æ—Ç–æ–Ω–Ω–∞:
*   –ê–∫–æ –µ –≤—ä–∑–º–æ–∂–Ω–æ –∑–∞ $X$, —Ç–æ –µ –≤—ä–∑–º–æ–∂–Ω–æ –∏ –∑–∞ –≤—Å—è–∫–æ $Y > X$ (–∏–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ—Ç–æ).

**–®–∞–±–ª–æ–Ω:**
```cpp
bool check(long long x) {
    // –í—ä–∑–º–æ–∂–Ω–æ –ª–∏ –µ –¥–∞ —Å–µ —Å–ø—Ä–∞–≤–∏–º —Å—ä—Å —Å—Ç–æ–π–Ω–æ—Å—Ç x?
    // Greedy –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏ —Å–∏–º—É–ª–∞—Ü–∏—è O(N)
    return true/false;
}

long long solve() {
    long long l = 0, r = 1e18; // –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞ —Ç—ä—Ä—Å–µ–Ω–µ
    long long ans = -1;
    
    while (l <= r) {
        long long mid = l + (r - l) / 2;
        if (check(mid)) {
            ans = mid;
            r = mid - 1; // –¢—ä—Ä—Å–∏–º –ø–æ-–º–∞–ª–∫–æ (–∑–∞ –º–∏–Ω–∏–º—É–º)
            // l = mid + 1; // –ó–∞ –º–∞–∫—Å–∏–º—É–º
        } else {
            l = mid + 1; // –¢—Ä—è–±–≤–∞ –ø–æ-–≥–æ–ª—è–º–æ
            // r = mid - 1; // –ó–∞ –º–∞–∫—Å–∏–º—É–º
        }
    }
    return ans;
}
```

### –ü—Ä–∏–º–µ—Ä–Ω–∏ –∑–∞–¥–∞—á–∏:
*   "Aggressive Cows" (SPOJ): –ú–∏–Ω–∏–º–∞–ª–Ω–æ—Ç–æ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫—Ä–∞–≤–∏ –¥–∞ –µ –º–∞–∫—Å–∏–º–∞–ª–Ω–æ.
*   "K-th Number": –ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ k-—Ç–æ—Ç–æ —á–∏—Å–ª–æ –≤ —Å–ª–æ–∂–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞.

## 4. –î–≤–æ–∏—á–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ –≤—ä—Ä—Ö—É —Ä–µ–∞–ª–Ω–∏ —á–∏—Å–ª–∞

–ö–æ–≥–∞—Ç–æ –æ—Ç–≥–æ–≤–æ—Ä—ä—Ç –µ –¥—Ä–æ–±–Ω–æ —á–∏—Å–ª–æ (`double`), –≤–º–µ—Å—Ç–æ `l <= r` –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —Ñ–∏–∫—Å–∏—Ä–∞–Ω –±—Ä–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏. –¢–æ–≤–∞ –µ –ø–æ-—Å—Ç–∞–±–∏–ª–Ω–æ –æ—Ç `while (r - l > EPS)` –∑–∞—Ä–∞–¥–∏ –ø—Ä–æ–±–ª–µ–º–∏—Ç–µ —Å —Ç–æ—á–Ω–æ—Å—Ç—Ç–∞.

```cpp
double l = 0, r = 1e9;
for (int i = 0; i < 100; i++) { // 100 –∏—Ç–µ—Ä–∞—Ü–∏–∏ –¥–∞–≤–∞—Ç –æ–≥—Ä–æ–º–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç
    double mid = (l + r) / 2;
    if (check(mid)) r = mid;
    else l = mid;
}
```

## 5. –¢—Ä–æ–∏—á–Ω–æ –¢—ä—Ä—Å–µ–Ω–µ (Ternary Search)

–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –∑–∞ –Ω–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ –º–∞–∫—Å–∏–º—É–º/–º–∏–Ω–∏–º—É–º –Ω–∞ **—É–Ω–∏–º–æ–¥–∞–ª–Ω–∞** —Ñ—É–Ω–∫—Ü–∏—è (—Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—è—Ç–æ —Ä–∞—Å—Ç–µ –∏ –ø–æ—Å–ª–µ –Ω–∞–º–∞–ª—è–≤–∞, –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ - –∏–º–∞ —Å–∞–º–æ –µ–¥–∏–Ω –µ–∫—Å—Ç—Ä–µ–º—É–º).

–†–∞–∑–¥–µ–ª—è–º–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –Ω–∞ 3 —á–∞—Å—Ç–∏ —Å –¥–≤–µ —Ç–æ—á–∫–∏ $m_1$ –∏ $m_2$:
$m_1 = l + (r-l)/3$
$m_2 = r - (r-l)/3$

*   –ê–∫–æ $f(m_1) < f(m_2)$: –ú–∞–∫—Å–∏–º—É–º—ä—Ç –µ –Ω–∞–¥—è—Å–Ω–æ, –º–µ—Å—Ç–∏–º $L = m_1$.
*   –ê–∫–æ $f(m_1) > f(m_2)$: –ú–∞–∫—Å–∏–º—É–º—ä—Ç –µ –Ω–∞–ª—è–≤–æ, –º–µ—Å—Ç–∏–º $R = m_2$.

## 6. –ó–∞–¥–∞—á–∏
1.  **Codeforces 706B**: Interesting drink (`upper_bound`).
2.  **SPOJ EKO**: –ö–ª–∞—Å–∏—á–µ—Å–∫–∏ BS –ø–æ –æ—Ç–≥–æ–≤–æ—Ä.
3.  **LeetCode 33**: Search in Rotated Sorted Array.

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–ê–∫–æ –≤–∏–¥–∏—Ç–µ "–º–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç" –∏–ª–∏ –¥—É–º–∞—Ç–∞ "–º–∞–∫—Å–∏–º–∏–∑–∏—Ä–∞–π –º–∏–Ω–∏–º—É–º–∞", –≤–µ–¥–Ω–∞–≥–∞ –º–∏—Å–ª–µ—Ç–µ –∑–∞ Binary Search.
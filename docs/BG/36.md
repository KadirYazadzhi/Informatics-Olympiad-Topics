# üßµ –ê–ª–≥–æ—Ä–∏—Ç–º–∏ –≤—ä—Ä—Ö—É –ù–∏–∑–æ–≤–µ (String Algorithms)

–ï—Ñ–µ–∫—Ç–∏–≤–Ω–∞—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ç–µ–∫—Å—Ç –µ –∫–ª—é—á–æ–≤–∞ –æ–±–ª–∞—Å—Ç. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Ç–æ —Ç—ä—Ä—Å–µ–Ω–µ (`std::string::find`) –µ $O(N \cdot M)$ –≤ –Ω–∞–π-–ª–æ—à–∏—è —Å–ª—É—á–∞–π, –∫–æ–µ—Ç–æ –µ –±–∞–≤–Ω–æ. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –ø–æ—Å—Ç–∏–≥–∞—Ç $O(N + M)$. 

## 1. –ü–æ–ª–∏–Ω–æ–º–Ω–æ –•–µ—à–∏—Ä–∞–Ω–µ (Rolling Hash)

–ù–∞–π-–≥—ä–≤–∫–∞–≤–∏—è—Ç –º–µ—Ç–æ–¥. –ü—Ä–µ–≤—Ä—ä—â–∞–º–µ –Ω–∏–∑–æ–≤–µ—Ç–µ –≤ —á–∏—Å–ª–∞, —Ç–∞–∫–∞ —á–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ—Ç–æ –¥–∞ —Å—Ç–∞–≤–∞ –∑–∞ $O(1)$.
–§–æ—Ä–º—É–ª–∞ –∑–∞ —Ö–µ—à –Ω–∞ –Ω–∏–∑ $S$:
$H(S) = (S[0] \cdot P^0 + S[1] \cdot P^1 + \dots + S[n-1] \cdot P^{n-1}) \pmod M$

*   $P$: –û—Å–Ω–æ–≤–∞ (–Ω–∞–ø—Ä. 31, 53, –∏–ª–∏ —Å–ª—É—á–∞–π–Ω–æ —á–∏—Å–ª–æ > —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –∞–∑–±—É–∫–∞—Ç–∞).
*   $M$: –ì–æ–ª—è–º–æ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ (–Ω–∞–ø—Ä. $10^9 + 7$). 

### Rolling Hash —Å–≤–æ–π—Å—Ç–≤–æ
–ú–æ–∂–µ–º –¥–∞ –∏–∑—á–∏—Å–ª–∏–º —Ö–µ—à–∞ –Ω–∞ –≤—Å–µ–∫–∏ –ø–æ–¥–Ω–∏–∑ $S[i \dots j]$ –∑–∞ $O(1)$, –∞–∫–æ —Å–º–µ –ø—Ä–µ–∫–∞–ª–∫—É–ª–∏—Ä–∞–ª–∏ –ø—Ä–µ—Ñ–∏–∫—Å–∏—Ç–µ:
$Hash(i, j) = (H[j] - H[i-1]) \cdot P^{-i} \pmod M$
–í–º–µ—Å—Ç–æ –¥–µ–ª–µ–Ω–∏–µ —Å $P^i$, –æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ —É–º–Ω–æ–∂–∞–≤–∞–º–µ –¥—è—Å–Ω–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ—Ç–æ, –∑–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ–º –º–æ–¥—É–ª—è—Ä–Ω–æ –æ–±—Ä–∞—Ç–Ω–æ.

**–î–≤–æ–µ–Ω –•–µ—à**: –ó–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ–º –∫–æ–ª–∏–∑–∏–∏ (—Ä–∞–∑–ª–∏—á–Ω–∏ –Ω–∏–∑–æ–≤–µ —Å –µ–¥–Ω–∞–∫—ä–≤ —Ö–µ—à), –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –¥–≤–µ –¥–≤–æ–π–∫–∏ $(P_1, M_1)$ –∏ $(P_2, M_2)$. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—Ç–∞ –∑–∞ –∫–æ–ª–∏–∑–∏—è —Å—Ç–∞–≤–∞ –Ω–∏—â–æ–∂–Ω–∞.

## 2. –ê–ª–≥–æ—Ä–∏—Ç—ä–º –Ω–∞ –ö–Ω—É—Ç-–ú–æ—Ä–∏—Å-–ü—Ä–∞—Ç (KMP)

–ò–∑–ø–æ–ª–∑–≤–∞ **–ü—Ä–µ—Ñ–∏–∫—Å–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è** ($\pi$).
$\pi[i]$ –µ –¥—ä–ª–∂–∏–Ω–∞—Ç–∞ –Ω–∞ –Ω–∞–π-–¥—ä–ª–≥–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω –ø—Ä–µ—Ñ–∏–∫—Å –Ω–∞ –ø–æ–¥–Ω–∏–∑–∞ $S[0 \dots i]$, –∫–æ–π—Ç–æ –µ –µ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏ –Ω–µ–≥–æ–≤ —Å—É—Ñ–∏–∫—Å.

–ü—Ä–∏–º–µ—Ä: $S = \text{"ababa"}$
*   $\pi[0]$ ("a") = 0
*   $\pi[1]$ ("ab") = 0
*   $\pi[2]$ ("aba") = 1 ("a")
*   $\pi[3]$ ("abab") = 2 ("ab")
*   $\pi[4]$ ("ababa") = 3 ("aba")

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ $\pi$:
1.  **–¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –ø–æ–¥–Ω–∏–∑**: –¢—ä—Ä—Å–∏–º $P$ –≤ $T$. –ü—Ä–∞–≤–∏–º –Ω–∏–∑ $S = P + \# + T$. –í—Å–∏—á–∫–∏ –ø–æ–∑–∏—Ü–∏–∏, –∫—ä–¥–µ—Ç–æ $\pi[i] == |P|$, —Å–∞ —Å—Ä–µ—â–∞–Ω–∏—è.
2.  **–ú–∏–Ω–∏–º–∞–ª–µ–Ω –ø–µ—Ä–∏–æ–¥**: –î—ä–ª–∂–∏–Ω–∞—Ç–∞ –Ω–∞ –Ω–∞–π-–º–∞–ª–∫–∏—è –ø–µ—Ä–∏–æ–¥ –Ω–∞ –Ω–∏–∑ —Å –¥—ä–ª–∂–∏–Ω–∞ $N$ –µ $N - \pi[N-1]$ (–∞–∫–æ $N$ —Å–µ –¥–µ–ª–∏ –Ω–∞ —Ç–æ–≤–∞ —á–∏—Å–ª–æ).

```cpp
vector<int> prefix_function(string s) {
    int n = s.length();
    vector<int> pi(n);
    for (int i = 1; i < n; i++) {
        int j = pi[i-1];
        while (j > 0 && s[i] != s[j])
            j = pi[j-1];
        if (s[i] == s[j])
            j++;
        pi[i] = j;
    }
    return pi;
}
```

## 3. Z-–ê–ª–≥–æ—Ä–∏—Ç—ä–º

–ò–∑—á–∏—Å–ª—è–≤–∞ **Z-—Ñ—É–Ω–∫—Ü–∏—è**.
$Z[i]$ –µ –¥—ä–ª–∂–∏–Ω–∞—Ç–∞ –Ω–∞ –Ω–∞–π-–¥—ä–ª–≥–∏—è –æ–±—â –ø—Ä–µ—Ñ–∏–∫—Å –º–µ–∂–¥—É –Ω–∏–∑–∞ $S$ –∏ —Å—É—Ñ–∏–∫—Å–∞ –Ω–∞ $S$, –∑–∞–ø–æ—á–≤–∞—â –æ—Ç $i$.
*   $Z[0]$ –æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ –Ω–µ —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ (–∏–ª–∏ –µ $N$).
*   –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –Ω–∞ KMP, –ø–æ–∑–≤–æ–ª—è–≤–∞ —Ç—ä—Ä—Å–µ–Ω–µ –Ω–∞ —à–∞–±–ª–æ–Ω –∑–∞ –ª–∏–Ω–µ–π–Ω–æ –≤—Ä–µ–º–µ.

## 4. –ê–ª–≥–æ—Ä–∏—Ç—ä–º –Ω–∞ –ú–∞–Ω–∞–∫—ä—Ä (Manacher)

–ù–∞–º–∏—Ä–∞ –Ω–∞–π-–¥—ä–ª–≥–∏—è –ø–∞–ª–∏–Ω–¥—Ä–æ–º –≤—ä–≤ –≤—Å—è–∫–∞ –ø–æ–∑–∏—Ü–∏—è –Ω–∞ –Ω–∏–∑–∞ –∑–∞ $O(N)$.
*   –†–∞–∑–≥–ª–µ–∂–¥–∞ –æ—Ç–¥–µ–ª–Ω–æ –ø–∞–ª–∏–Ω–¥—Ä–æ–º–∏ —Å –Ω–µ—á–µ—Ç–Ω–∞ –¥—ä–ª–∂–∏–Ω–∞ (—Ü–µ–Ω—Ç—ä—Ä –≤ —Å–∏–º–≤–æ–ª) –∏ —á–µ—Ç–Ω–∞ –¥—ä–ª–∂–∏–Ω–∞ (—Ü–µ–Ω—Ç—ä—Ä –º–µ–∂–¥—É —Å–∏–º–≤–æ–ª–∏).

## 5. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –ê–ª–≥–æ—Ä–∏—Ç—ä–º | –°–ª–æ–∂–Ω–æ—Å—Ç | –ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞ | –ù–µ–¥–æ—Å—Ç–∞—Ç—ä—Ü–∏ |
| :--- | :--- | :--- | :--- |
| **Hashing** | $O(N)$ | –õ–µ—Å–µ–Ω –∫–æ–¥, –≥—ä–≤–∫–∞–≤ (–ø–∞–ª–∏–Ω–¥—Ä–æ–º–∏, —Å—Ä–∞–≤–Ω–µ–Ω–∏—è) | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç –∑–∞ –∫–æ–ª–∏–∑–∏—è (–º–∞–∫–∞—Ä –∏ –º–∞–ª–∫–∞) |
| **KMP** | $O(N)$ | –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–µ–Ω, –ø–æ–ª–µ–∑–µ–Ω –∑–∞ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç | –ú–∞–ª–∫–æ –ø–æ-—Å–ª–æ–∂–Ω–∞ –ª–æ–≥–∏–∫–∞ |
| **Z-Algo** | $O(N)$ | –ü–æ-–∏–Ω—Ç—É–∏—Ç–∏–≤–µ–Ω –∑–∞ –Ω—è–∫–æ–∏ –∑–∞–¥–∞—á–∏ –æ—Ç KMP | –ü–æ-—Ä—è–¥–∫–æ –∏–∑–ø–æ–ª–∑–≤–∞–Ω |
| **Aho-Corasick**| $O(N)$ | –¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ **–º–Ω–æ–∂–µ—Å—Ç–≤–æ** —à–∞–±–ª–æ–Ω–∏ –µ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ | –ë–∞–∑–∏—Ä–∞–Ω –Ω–∞ Trie (–¢–µ–º–∞ 26) |

## 6. –ó–∞–¥–∞—á–∏
1.  **Codeforces 1200E**: Compress Words (KMP/Hashing).
2.  **SPOJ NHAY**: –¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –∏–≥–ª–∞ –≤ –∫—É–ø–∞ —Å–µ–Ω–æ.
3.  **CSES String Matching**: –ë–∞–∑–æ–≤–∞ –∑–∞–¥–∞—á–∞.

```
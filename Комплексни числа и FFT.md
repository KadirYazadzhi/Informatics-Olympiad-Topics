# üìê –ö–æ–º–ø–ª–µ–∫—Å–Ω–∏ —á–∏—Å–ª–∞ –∏ FFT

## üìê –ö–æ–º–ø–ª–µ–∫—Å–Ω–∏ —á–∏—Å–ª–∞

–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ—Ç–æ —á–∏—Å–ª–æ –∏–º–∞ –≤–∏–¥–∞ $z = a + bi$, –∫—ä–¥–µ—Ç–æ $i^2 = -1$.
- **–ü–æ–ª—è—Ä–Ω–∞ —Ñ–æ—Ä–º–∞**: $z = r(\cos \theta + i \sin \theta) = r e^{i\theta}$.
- **–§–æ—Ä–º—É–ª–∞ –Ω–∞ –û–π–ª–µ—Ä**: $e^{i\pi} + 1 = 0$.

–í C++ –º–æ–∂–µ–º –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ `std::complex<double>`.

---

## ‚ö° –ë—ä—Ä–∑–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ –§—É—Ä–∏–µ (FFT)

FFT –µ –∞–ª–≥–æ—Ä–∏—Ç—ä–º –∑–∞ –ø—Ä–µ–º–∏–Ω–∞–≤–∞–Ω–µ –æ—Ç **–∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–Ω–æ** –ø—Ä–µ–¥—Å—Ç–∞–≤—è–Ω–µ –Ω–∞ –ø–æ–ª–∏–Ω–æ–º –∫—ä–º –ø—Ä–µ–¥—Å—Ç–∞–≤—è–Ω–µ —á—Ä–µ–∑ **—Å—Ç–æ–π–Ω–æ—Å—Ç–∏** –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏ —Ç–æ—á–∫–∏ (–∏ –æ–±—Ä–∞—Ç–Ω–æ) –∑–∞ $O(n \log n)$.

### –ó–∞—â–æ –µ –ø–æ–ª–µ–∑–Ω–æ?
–£–º–Ω–æ–∂–µ–Ω–∏–µ—Ç–æ –Ω–∞ –¥–≤–∞ –ø–æ–ª–∏–Ω–æ–º–∞ –≤ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–µ–Ω –≤–∏–¥ –µ $O(n^2)$. –í –ø—Ä–µ–¥—Å—Ç–∞–≤—è–Ω–µ —á—Ä–µ–∑ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, —É–º–Ω–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –ø–æ—Ç–æ—á–Ω–æ ‚Äì $O(n)$.
- **–ü–ª–∞–Ω –∑–∞ —É–º–Ω–æ–∂–µ–Ω–∏–µ**: –ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏ $\to$ FFT $\to$ –°—Ç–æ–π–Ω–æ—Å—Ç–∏ $\to$ –£–º–Ω–æ–∂–µ–Ω–∏–µ $\to$ Inverse FFT $\to$ –ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∏.

---

## üèóÔ∏è –ö–æ—Ä–µ–Ω–∏ –Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞—Ç–∞ (Roots of Unity)

FFT –∏–∑–ø–æ–ª–∑–≤–∞ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ —Ç–æ—á–∫–∏ ‚Äì –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏—Ç–µ —á–∏—Å–ª–∞ $w_k = e^{i \frac{2\pi k}{n}}$, –∫–æ–∏—Ç–æ –ª–µ–∂–∞—Ç –Ω–∞ –µ–¥–∏–Ω–∏—á–Ω–∞—Ç–∞ –æ–∫—Ä—ä–∂–Ω–æ—Å—Ç. –¢–µ –∏–º–∞—Ç —Å–≤–æ–π—Å—Ç–≤–æ—Ç–æ, —á–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—Ç–µ –∏–º —Å–µ –ø–æ–≤—Ç–∞—Ä—è—Ç, –∫–æ–µ—Ç–æ –ø–æ–∑–≤–æ–ª—è–≤–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ç–∞ "–†–∞–∑–¥–µ–ª—è–π –∏ –≤–ª–∞–¥–µ–π".

---

## üõ†Ô∏è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ C++ (Recursive FFT)
```cpp
#include <complex>
#include <vector>
#include <cmath>

using cd = std::complex<double>;
const double PI = std::acos(-1);

void fft(std::vector<cd>& a, bool invert) {
    int n = a.size();
    if (n == 1) return;

    std::vector<cd> a0(n / 2), a1(n / 2);
    for (int i = 0; 2 * i < n; i++) {
        a0[i] = a[2 * i];
        a1[i] = a[2 * i + 1];
    }
    fft(a0, invert);
    fft(a1, invert);

    double ang = 2 * PI / n * (invert ? -1 : 1);
    cd w(1), wn(std::cos(ang), std::sin(ang));
    for (int i = 0; 2 * i < n; i++) {
        a[i] = a0[i] + w * a1[i];
        a[i + n / 2] = a0[i] - w * a1[i];
        if (invert) {
            a[i] /= 2;
            a[i + n / 2] /= 2;
        }
        w *= wn;
    }
}
```

---

## üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. **–£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –æ–≥—Ä–æ–º–Ω–∏ —á–∏—Å–ª–∞/–ø–æ–ª–∏–Ω–æ–º–∏**: $O(n \log n)$ –≤–º–µ—Å—Ç–æ $O(n^2)$.
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–∏–≥–Ω–∞–ª–∏**: –ê–Ω–∞–ª–∏–∑ –Ω–∞ —á–µ—Å—Ç–æ—Ç–Ω–∏—è —Å–ø–µ–∫—Ç—ä—Ä.
3. **–†–µ—à–∞–≤–∞–Ω–µ –Ω–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ —á–∞—Å—Ç–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∏**.

---

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ë—ä—Ä–∑–æ—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ –§—É—Ä–∏–µ –µ –µ–¥–∏–Ω –æ—Ç –Ω–∞–π-–≤–ª–∏—è—Ç–µ–ª–Ω–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –Ω–∞ 20-—Ç–∏ –≤–µ–∫. –í –æ–ª–∏–º–ø–∏–∞–¥–Ω–æ—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ —Ç–æ –µ "–∑–ª–∞—Ç–Ω–∏—è—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç" –∑–∞ –∑–∞–¥–∞—á–∏, –∏–∑–∏—Å–∫–≤–∞—â–∏ –±—ä—Ä–∑–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–∏–Ω–æ–º–∏ –∏–ª–∏ —Ä–∞–±–æ—Ç–∞ —Å —á–µ—Å—Ç–æ—Ç–∏. üöÄ

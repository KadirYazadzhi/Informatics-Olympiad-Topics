# üß± –†–∞–∑—à–∏—Ä–µ–Ω–∏ –•–µ–ø–æ–≤–µ (Advanced Heaps)

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ "–î–≤–æ–∏—á–Ω–∞ –ø–∏—Ä–∞–º–∏–¥–∞" (Binary Heap), –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∞ –≤ `std::priority_queue`, –µ –∏–∑–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏—Ç–µ `push` ($O(\log N)$) –∏ `pop` ($O(\log N)$). –í—ä–ø—Ä–µ–∫–∏ —Ç–æ–≤–∞, —Ç—è –∏–º–∞ –µ–¥–∏–Ω —Å—ä—â–µ—Å—Ç–≤–µ–Ω –Ω–µ–¥–æ—Å—Ç–∞—Ç—ä–∫: —Å–ª–∏–≤–∞–Ω–µ—Ç–æ (merge) –Ω–∞ –¥–≤–µ –ø–∏—Ä–∞–º–∏–¥–∏ –æ—Ç–Ω–µ–º–∞ $O(N)$ –≤—Ä–µ–º–µ.

–í –º–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ (–Ω–∞–ø—Ä. Minimum Spanning Tree —Å –∞–ª–≥–æ—Ä–∏—Ç—ä–º –Ω–∞ Chu-Liu/Edmonds, Dijkstra –≤—ä—Ä—Ö—É —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ –≥—Ä–∞—Ñ–∏) —Å–µ –Ω–∞–ª–∞–≥–∞ –µ—Ñ–∏–∫–∞—Å–Ω–æ —Å–ª–∏–≤–∞–Ω–µ –Ω–∞ –æ–ø–∞—à–∫–∏. –¢—É–∫ –Ω–∞ –ø–æ–º–æ—â –∏–¥–≤–∞—Ç **–û–±–µ–¥–∏–Ω—è–µ–º–∏—Ç–µ –ø–∏—Ä–∞–º–∏–¥–∏ (Mergeable Heaps)**.

---

## 1. –õ—è–≤–∞ –ø–∏—Ä–∞–º–∏–¥–∞ (Leftist Heap)

–õ—è–≤–∞—Ç–∞ –ø–∏—Ä–∞–º–∏–¥–∞ –µ –¥–≤–æ–∏—á–Ω–æ –¥—ä—Ä–≤–æ, –∫–æ–µ—Ç–æ —Å–ø–∞–∑–≤–∞ –¥–≤–µ —Å–≤–æ–π—Å—Ç–≤–∞:
1.  **Heap Property**: –°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –≤—ä–≤ –≤—Å–µ–∫–∏ –≤—ä–∑–µ–ª –µ –ø–æ-–º–∞–ª–∫–∞ (–∏–ª–∏ –ø–æ-–≥–æ–ª—è–º–∞, –∑–∞ max-heap) –æ—Ç —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ –¥–µ—Ü–∞—Ç–∞ –º—É.
2.  **Leftist Property**: –ó–∞ –≤—Å–µ–∫–∏ –≤—ä–∑–µ–ª, "—Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ—Ç–æ" –¥–æ –Ω–∞–π-–±–ª–∏–∑–∫–∏—è `null` –Ω–∞—Å–ª–µ–¥–Ω–∏–∫ –≤ –¥—è—Å–Ω–æ—Ç–æ –ø–æ–¥–¥—ä—Ä–≤–æ –µ –ø–æ-–º–∞–ª–∫–æ –∏–ª–∏ —Ä–∞–≤–Ω–æ –Ω–∞ —Ç–æ–≤–∞ –≤ –ª—è–≤–æ—Ç–æ.
    *   –ù–µ–∫–∞ $dist(u)$ –µ –¥—ä–ª–∂–∏–Ω–∞—Ç–∞ –Ω–∞ –Ω–∞–π-–∫—ä—Å–∏—è –ø—ä—Ç –æ—Ç $u$ –¥–æ –≤—ä–∑–µ–ª, –∫–æ–π—Ç–æ –Ω—è–º–∞ –¥–≤–µ –¥–µ—Ü–∞.
    *   –ò–∑–∏—Å–∫–≤–∞–Ω–µ: $dist(u \to left) \ge dist(u \to right)$.

–¢–æ–≤–∞ —Å–≤–æ–π—Å—Ç–≤–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ –¥–µ—Å–Ω–∏—è—Ç –ø—ä—Ç (Right Spine) –Ω–∞ –¥—ä—Ä–≤–æ—Ç–æ –µ –∫—Ä–∞—Ç—ä–∫: –¥—ä–ª–∂–∏–Ω–∞—Ç–∞ –º—É –µ –Ω–∞–π-–º–Ω–æ–≥–æ $O(\log N)$. –¢—ä–π –∫–∞—Ç–æ –ø–æ–≤–µ—á–µ—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞—Ç –ø–æ –¥–µ—Å–Ω–∏—è –ø—ä—Ç, —Ç–µ —Å–∞ –ª–æ–≥–∞—Ä–∏—Ç–º–∏—á–Ω–∏.

### 1.1. –û–ø–µ—Ä–∞—Ü–∏—è –°–ª–∏–≤–∞–Ω–µ (Merge)
–¢–æ–≤–∞ –µ –æ—Å–Ω–æ–≤–Ω–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è. –í—Å–∏—á–∫–∏ –¥—Ä—É–≥–∏ (insert, pop) —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞—Ç —á—Ä–µ–∑ –Ω–µ—è.
–ó–∞ –¥–∞ —Å–ª–µ–µ–º –¥–≤–µ –ø–∏—Ä–∞–º–∏–¥–∏ $A$ –∏ $B$:
1.  –ê–∫–æ –µ–¥–Ω–∞—Ç–∞ –µ –ø—Ä–∞–∑–Ω–∞, –≤—Ä—ä—â–∞–º–µ –¥—Ä—É–≥–∞—Ç–∞.
2.  –ù–µ–∫–∞ –∫–æ—Ä–µ–Ω—ä—Ç –Ω–∞ $A$ –µ –ø–æ-–º–∞–ª—ä–∫ –æ—Ç –∫–æ—Ä–µ–Ω–∞ –Ω–∞ $B$ (–∑–∞ min-heap). –ê–∫–æ –Ω–µ, —Ä–∞–∑–º–µ–Ω—è–º–µ $A$ –∏ $B$.
3.  –°–ª–∏–≤–∞–º–µ –¥—è—Å–Ω–æ—Ç–æ –¥–µ—Ç–µ –Ω–∞ $A$ —Å $B$: `A->right = merge(A->right, B)`.
4.  –°–ª–µ–¥ —Å–ª–∏–≤–∞–Ω–µ—Ç–æ, –∞–∫–æ $dist(A \to left) < dist(A \to right)$, —Ä–∞–∑–º–µ–Ω—è–º–µ –ª—è–≤–æ—Ç–æ –∏ –¥—è—Å–Ω–æ—Ç–æ –¥–µ—Ç–µ –Ω–∞ $A$, –∑–∞ –¥–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–∏–º leftist —Å–≤–æ–π—Å—Ç–≤–æ—Ç–æ.
5.  –û–±–Ω–æ–≤—è–≤–∞–º–µ $dist(A) = dist(A \to right) + 1$.

–°–ª–æ–∂–Ω–æ—Å—Ç: $O(\log N)$.

```cpp
struct Node {
    int val, dist;
    Node *left, *right;
    Node(int v) : val(v), dist(0), left(nullptr), right(nullptr) {}
};

Node* merge(Node* a, Node* b) {
    if (!a) return b;
    if (!b) return a;
    if (a->val > b->val) swap(a, b); // Min-heap
    
    a->right = merge(a->right, b);
    
    if (!a->left || a->left->dist < a->right->dist) {
        swap(a->left, a->right);
    }
    
    if (a->right) a->dist = a->right->dist + 1;
    else a->dist = 0;
    
    return a;
}
```

---

## 2. Skew Heap (–ù–∞–∫–ª–æ–Ω–µ–Ω–∞ –ø–∏—Ä–∞–º–∏–¥–∞)

Skew Heap –µ –æ–ø—Ä–æ—Å—Ç–µ–Ω –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ Leftist Heap.
*   **–ò–¥–µ—è**: –ù–µ –µ –Ω—É–∂–Ω–æ –¥–∞ –ø–∞–∑–∏–º –∏ –ø–æ–¥–¥—ä—Ä–∂–∞–º–µ —Ç–æ—á–Ω–∞—Ç–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –Ω–∞ $dist$. –í–º–µ—Å—Ç–æ —Ç–æ–≤–∞, –Ω–∏–µ **–≤–∏–Ω–∞–≥–∏** —Ä–∞–∑–º–µ–Ω—è–º–µ –ª—è–≤–æ—Ç–æ –∏ –¥—è—Å–Ω–æ—Ç–æ –¥–µ—Ç–µ —Å–ª–µ–¥ —Å–ª–∏–≤–∞–Ω–µ.
*   –¢–æ–≤–∞ –µ —Å–∞–º–æ—Ä–µ–≥—É–ª–∏—Ä–∞—â–∞ —Å–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø–æ–¥–æ–±–Ω–æ –Ω–∞ Splay –¥—ä—Ä–≤–µ—Ç–∞—Ç–∞).
*   –ù—è–º–∞ –≥–∞—Ä–∞–Ω—Ü–∏—è –∑–∞ –ª–æ–≥–∞—Ä–∏—Ç–º–∏—á–Ω–∞ –≤–∏—Å–æ—á–∏–Ω–∞ –≤ –Ω–∞–π-–ª–æ—à–∏—è —Å–ª—É—á–∞–π ($O(N)$), –Ω–æ **–∞–º–æ—Ä—Ç–∏–∑–∏—Ä–∞–Ω–∞—Ç–∞** —Å–ª–æ–∂–Ω–æ—Å—Ç –µ $O(\log N)$.

### 2.1. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è
–ö–æ–¥—ä—Ç –µ –∏–∑–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –∫—Ä–∞—Ç—ä–∫ –∏ –µ–ª–µ–≥–∞–Ω—Ç–µ–Ω:

```cpp
struct SkewNode {
    int val;
    SkewNode *left, *right;
    SkewNode(int v) : val(v), left(nullptr), right(nullptr) {}
};

SkewNode* skew_merge(SkewNode* a, SkewNode* b) {
    if (!a) return b;
    if (!b) return a;
    if (a->val > b->val) swap(a, b);
    
    // –°–ª–∏–≤–∞–º–µ –¥—è—Å–Ω–æ—Ç–æ –¥—ä—Ä–≤–æ —Å b
    a->right = skew_merge(a->right, b);
    
    // –í–∏–Ω–∞–≥–∏ —Ä–∞–∑–º–µ–Ω—è–º–µ –¥–µ—Ü–∞—Ç–∞ (—Ç–æ–≤–∞ –æ—Å–∏–≥—É—Ä—è–≤–∞ –∞–º–æ—Ä—Ç–∏–∑–∏—Ä–∞–Ω–∏—è –±–∞–ª–∞–Ω—Å)
    swap(a->left, a->right);
    
    return a;
}
```
–¢–æ–≤–∞ –µ –ø—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–∞—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞ —Å—ä—Å—Ç–µ–∑–∞–Ω–∏—è, –∞–∫–æ –≤–∏ —Ç—Ä—è–±–≤–∞ –æ–±–µ–¥–∏–Ω—è–µ–º–∞ –ø–∏—Ä–∞–º–∏–¥–∞, –ø–æ—Ä–∞–¥–∏ –ø—Ä–æ—Å—Ç–æ—Ç–∞—Ç–∞ —Å–∏.

---

## 3. Binomial Heap (–ë–∏–Ω–æ–º–∏–∞–ª–Ω–∞ –ø–∏—Ä–∞–º–∏–¥–∞)

–ë–∏–Ω–æ–º–∏–∞–ª–Ω–∞—Ç–∞ –ø–∏—Ä–∞–º–∏–¥–∞ –µ –∫–æ–ª–µ–∫—Ü–∏—è –æ—Ç **–±–∏–Ω–æ–º–∏–∞–ª–Ω–∏ –¥—ä—Ä–≤–µ—Ç–∞**.
*   –ë–∏–Ω–æ–º–∏–∞–ª–Ω–æ –¥—ä—Ä–≤–æ –æ—Ç —Ä–µ–¥ $k$ ($B_k$) —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ:
    *   $B_0$ –µ –µ–¥–∏–Ω –≤—ä–∑–µ–ª.
    *   $B_k$ —Å–µ –ø–æ–ª—É—á–∞–≤–∞ –æ—Ç –¥–≤–µ –¥—ä—Ä–≤–µ—Ç–∞ $B_{k-1}$, –∫–∞—Ç–æ –∫–æ—Ä–µ–Ω—ä—Ç –Ω–∞ –µ–¥–Ω–æ—Ç–æ —Å—Ç–∞–≤–∞ –¥–µ—Ç–µ –Ω–∞ –∫–æ—Ä–µ–Ω–∞ –Ω–∞ –¥—Ä—É–≥–æ—Ç–æ.
*   –ò–º–∞ —Ç–æ—á–Ω–æ $2^k$ –≤—ä–∑–µ–ª–∞.
*   –í—Å–µ–∫–∏ —Ö–∏–π–ø —Å–µ –ø—Ä–µ–¥—Å—Ç–∞–≤—è –∫–∞—Ç–æ —Å–±–æ—Ä –æ—Ç —É–Ω–∏–∫–∞–ª–Ω–∏ –±–∏–Ω–æ–º–∏–∞–ª–Ω–∏ –¥—ä—Ä–≤–µ—Ç–∞ (–ø–æ–¥–æ–±–Ω–æ –Ω–∞ –¥–≤–æ–∏—á–Ω–∏—è –∑–∞–ø–∏—Å –Ω–∞ –±—Ä–æ—è –µ–ª–µ–º–µ–Ω—Ç–∏).

–û–ø–µ—Ä–∞—Ü–∏—è—Ç–∞ `merge` –Ω–∞–ø–æ–¥–æ–±—è–≤–∞ –¥–≤–æ–∏—á–Ω–æ —Å—ä–±–∏—Ä–∞–Ω–µ. –ê–∫–æ –∏ –¥–≤–µ—Ç–µ –ø–∏—Ä–∞–º–∏–¥–∏ –∏–º–∞—Ç –¥—ä—Ä–≤–æ –æ—Ç —Ä–µ–¥ $k$, —Ç–µ —Å–µ —Å–ª–∏–≤–∞—Ç –≤ –¥—ä—Ä–≤–æ –æ—Ç —Ä–µ–¥ $k+1$.
–°–ª–æ–∂–Ω–æ—Å—Ç: $O(\log N)$.
–ë–∏–Ω–æ–º–∏–∞–ª–Ω–∏—Ç–µ –ø–∏—Ä–∞–º–∏–¥–∏ —Å–∞ –æ—Å–Ω–æ–≤–∞—Ç–∞ –∑–∞ –ø–æ-—Å–ª–æ–∂–Ω–∏—Ç–µ **Fibonacci Heaps**, –∫–æ–∏—Ç–æ –ø–æ—Å—Ç–∏–≥–∞—Ç $O(1)$ –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏—è `decrease_key`.

---

## 4. Treap –∫–∞—Ç–æ –ø–∏—Ä–∞–º–∏–¥–∞

–¢—ä–π –∫–∞—Ç–æ Treap (Decartes Tree) –ø–æ–¥–¥—ä—Ä–∂–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏—Ç–µ `split` –∏ `merge` –∑–∞ $O(\log N)$, —Ç–æ–π –º–æ–∂–µ –ª–µ—Å–Ω–æ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∫–∞—Ç–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞ –æ–ø–∞—à–∫–∞.
*   –ò–∑–ø–æ–ª–∑–≤–∞–º–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –∫–∞—Ç–æ –∫–ª—é—á–æ–≤–µ –∑–∞ BST —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞.
*   –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∏—Ç–µ (—Å–ª—É—á–∞–π–Ω–∏—Ç–µ —á–∏—Å–ª–∞) –ø–æ–¥–¥—ä—Ä–∂–∞—Ç –±–∞–ª–∞–Ω—Å–∞.
*   `merge` –Ω–∞ –¥–≤–µ –¥—ä—Ä–≤–µ—Ç–∞ –∏–∑–∏—Å–∫–≤–∞ –≤—Å–∏—á–∫–∏ –∫–ª—é—á–æ–≤–µ –≤ –µ–¥–Ω–æ—Ç–æ –¥–∞ —Å–∞ –ø–æ-–º–∞–ª–∫–∏ –æ—Ç —Ç–µ–∑–∏ –≤ –¥—Ä—É–≥–æ—Ç–æ (–∫–æ–µ—Ç–æ –Ω–µ –µ –≤–∏–Ω–∞–≥–∏ –≤—è—Ä–Ω–æ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–ª–Ω–∏ —Ö–∏–π–ø–æ–≤–µ), —Ç–∞–∫–∞ —á–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—è—Ç Treap –Ω–µ –µ –¥–∏—Ä–µ–∫—Ç–µ–Ω –∑–∞–º–µ—Å—Ç–∏—Ç–µ–ª –Ω–∞ Mergeable Heap –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–ª–Ω–∏ –¥–∞–Ω–Ω–∏, –æ—Å–≤–µ–Ω –∞–∫–æ –Ω–µ —Å–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–∞.

–í—ä–ø—Ä–µ–∫–∏ —Ç–æ–≤–∞, **Randomized Meldable Heap** –µ –≤–∞—Ä–∏–∞—Ü–∏—è, –∫—ä–¥–µ—Ç–æ –ø—Ä–∏ —Å–ª–∏–≤–∞–Ω–µ –Ω–∞ –¥–≤–∞ –≤—ä–∑–µ–ª–∞, —Ä–µ—à–µ–Ω–∏–µ—Ç–æ –∫–æ–π –¥–∞ —Å—Ç–∞–Ω–µ –∫–æ—Ä–µ–Ω (–∞–∫–æ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ —Å–∞ —Ä–∞–≤–Ω–∏ –∏–ª–∏ –±–ª–∏–∑–∫–∏) –∏–ª–∏ –≤ –∫–æ–µ –ø–æ–¥–¥—ä—Ä–≤–æ –¥–∞ —Å–µ –ø—Ä–æ–¥—ä–ª–∂–∏, —Å–µ –≤–∑–∏–º–∞ –Ω–∞ —Å–ª—É—á–∞–µ–Ω –ø—Ä–∏–Ω—Ü–∏–ø. –¢–æ–≤–∞ —Ä–∞–±–æ—Ç–∏ –º–Ω–æ–≥–æ –ø–æ–¥–æ–±–Ω–æ –Ω–∞ Skew Heap, –Ω–æ —Å—ä—Å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç –≤–º–µ—Å—Ç–æ –±–µ–∑—É—Å–ª–æ–≤–Ω–∞ —Ä–∞–∑–º—è–Ω–∞.

---

## 5. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | Insert | Pop Min | Merge | Decrease Key | –°–ª–æ–∂–Ω–æ—Å—Ç –Ω–∞ –∫–æ–¥–∞ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Binary Heap** | $O(\log N)$ | $O(\log N)$ | $O(N)$ | $O(\log N)$ | –ù–∏—Å—ä–∫ (STL) |
| **Leftist Heap** | $O(\log N)$ | $O(\log N)$ | $O(\log N)$ | $O(\log N)$ | –°—Ä–µ–¥–µ–Ω |
| **Skew Heap** | $O(\log N)^*$ | $O(\log N)^*$ | $O(\log N)^*$ | $O(\log N)^*$ | –ù–∏—Å—ä–∫ |
| **Fibonacci** | $O(1)$ | $O(\log N)$ | $O(1)$ | $O(1)$ | –ú–Ω–æ–≥–æ –í–∏—Å–æ–∫ |

*$^*$ –ê–º–æ—Ä—Ç–∏–∑–∏—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç.*

**–ö–æ–≥–∞ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ Mergeable Heap?**
1.  –í –∑–∞–¥–∞—á–∏, –∏–∑–∏—Å–∫–≤–∞—â–∏ –æ–±–µ–¥–∏–Ω—è–≤–∞–Ω–µ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏ —Ç—ä—Ä—Å–µ–Ω–µ –Ω–∞ –º–∏–Ω–∏–º—É–º –≤—ä–≤ –≤—Å—è–∫–æ (–Ω–∞–ø—Ä. "Monkey King" –≤ SPOJ).
2.  –ü—Ä–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω–∏ –≥—Ä–∞—Ñ–∏–≤–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏.

–ó–∞ —Å—ä—Å—Ç–µ–∑–∞—Ç–µ–ª–Ω–∏ —Ü–µ–ª–∏: **Skew Heap** –µ –Ω–∞–π-–¥–æ–±—Ä–∏—è—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç –Ω–∞ –ø–∏—Å–∞–Ω–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç.

# üîÑ –î–∏–Ω–∞–º–∏—á–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ (Advanced)

## üîÑ –î–ü –ø–æ –ø—Ä–æ—Ñ–∏–ª (Broken Profile DP)

–î–ü –ø–æ –ø—Ä–æ—Ñ–∏–ª —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ —Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ –∑–∞–¥–∞—á–∏ –∑–∞ –∑–∞–ø—ä–ª–≤–∞–Ω–µ –Ω–∞ —Ñ–∏–≥—É—Ä–∏ (–Ω–∞–ø—Ä. –¥–æ–º–∏–Ω–æ –≤—ä—Ä—Ö—É –ø—Ä–∞–≤–æ—ä–≥—ä–ª–Ω–∞ –º—Ä–µ–∂–∞).
- **–°—ä—Å—Ç–æ—è–Ω–∏–µ**: –°—ä—Ö—Ä–∞–Ω—è–≤–∞–º–µ "–≥—Ä–∞–Ω–∏—Ü–∞—Ç–∞" (–ø—Ä–æ—Ñ–∏–ª–∞) –Ω–∞ –∑–∞–ø—ä–ª–Ω–µ–Ω–∞—Ç–∞ –æ–±–ª–∞—Å—Ç –∫–∞—Ç–æ –±–∏—Ç–æ–≤–∞ –º–∞—Å–∫–∞.
- –û–±–∏–∫–Ω–æ–≤–µ–Ω–æ —Å–µ –¥–≤–∏–∂–∏–º –∫–ª–µ—Ç–∫–∞ –ø–æ –∫–ª–µ—Ç–∫–∞ –∏–ª–∏ —Ä–µ–¥ –ø–æ —Ä–µ–¥.

---

## üìà –î–ü —Å –ú–∞—Ç—Ä–∏—á–Ω–æ –ø–æ–≤–¥–∏–≥–∞–Ω–µ –≤ —Å—Ç–µ–ø–µ–Ω

–ö–æ–≥–∞—Ç–æ –∏–º–∞–º–µ –ª–∏–Ω–µ–π–Ω–∞ —Ä–µ–∫—É—Ä–µ–Ω—Ç–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç (–∫–∞—Ç–æ –§–∏–±–æ–Ω–∞—á–∏):
$$F_n = F_{n-1} + F_{n-2}$$
–ú–æ–∂–µ–º –¥–∞ —è –∑–∞–ø–∏—à–µ–º —á—Ä–µ–∑ –º–∞—Ç—Ä–∏—Ü–∞:
$$\begin{pmatrix} F_n \\ F_{n-1} \end{pmatrix} = \begin{pmatrix} 1 & 1 \\ 1 & 0 \end{pmatrix} \begin{pmatrix} F_{n-1} \\ F_{n-2} \end{pmatrix}$$
–ü—Ä–µ—Å–º—è—Ç–∞–Ω–µ—Ç–æ –Ω–∞ $F_n$ —Å—Ç–∞–≤–∞ —á—Ä–µ–∑ –ø–æ–≤–¥–∏–≥–∞–Ω–µ –Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞—Ç–∞ –Ω–∞ —Å—Ç–µ–ø–µ–Ω $n$ –∑–∞ $O(\text{dim}^3 \log n)$. –¢–æ–≤–∞ –µ –∏–∑–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –±—ä—Ä–∑–æ –∑–∞ –æ–≥—Ä–æ–º–Ω–∏ $n$.

---

## üõ†Ô∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ –î–ü

### 1. Convex Hull Trick (CHT)
–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ, –∫–æ–≥–∞—Ç–æ –ø—Ä–µ—Ö–æ–¥—ä—Ç –∏–º–∞ –≤–∏–¥: $dp[i] = \min (m_j \cdot x_i + c_j)$.
- –¢–æ–≤–∞ –ø—Ä–∏–ª–∏—á–∞ –Ω–∞ –Ω–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ –¥–æ–ª–Ω–∞ –æ–±–≤–∏–≤–∫–∞ –Ω–∞ –Ω–∞–±–æ—Ä –æ—Ç –ø—Ä–∞–≤–∏. –ü–æ–∑–≤–æ–ª—è–≤–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç $O(n^2)$ –¥–æ $O(n \log n)$ –∏–ª–∏ $O(n)$.

### 2. Knuth Optimization
–ü—Ä–∏–ª–∞–≥–∞ —Å–µ –∑–∞ –∑–∞–¥–∞—á–∏ –æ—Ç —Ç–∏–ø "–û–ø—Ç–∏–º–∞–ª–Ω–æ –¥–≤–æ–∏—á–Ω–æ –¥—ä—Ä–≤–æ –∑–∞ —Ç—ä—Ä—Å–µ–Ω–µ" –∏–ª–∏ "–†–∞–∑—Ü–µ–ø–≤–∞–Ω–µ –Ω–∞ –Ω–∏–∑–æ–≤–µ", –∫—ä–¥–µ—Ç–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –µ $dp[i][j]$. –ê–∫–æ –æ–ø—Ç–∏–º–∞–ª–Ω–∏—è—Ç —Ä–∞–∑—Ü–µ–ø–≤–∞—â –∏–Ω–¥–µ–∫—Å $k$ –µ –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ –Ω–∞—Ä–∞—Å—Ç–≤–∞—â:
$$opt[i][j-1] \le opt[i][j] \le opt[i+1][j]$$
–¢–æ–≤–∞ –Ω–∞–º–∞–ª—è–≤–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—Ç–∞ –æ—Ç $O(n^3)$ –Ω–∞ $O(n^2)$.

### 3. Divide and Conquer Optimization
–ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –ø—Ä–∏ –∑–∞–¥–∞—á–∏ –∑–∞ —Ä–∞–∑–¥–µ–ª—è–Ω–µ –Ω–∞ –º–∞—Å–∏–≤ –Ω–∞ $K$ —á–∞—Å—Ç–∏, –∫–æ–≥–∞—Ç–æ –æ–ø—Ç–∏–º–∞–ª–Ω–∏—è—Ç —Ä–∞–∑—Ü–µ–ø–≤–∞—â –∏–Ω–¥–µ–∫—Å –µ –º–æ–Ω–æ—Ç–æ–Ω–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –ø–æ–∑–∏—Ü–∏—è—Ç–∞.

---

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ù–∞–ø—Ä–µ–¥–Ω–∞–ª–∏—Ç–µ —Ç–µ—Ö–Ω–∏–∫–∏ –≤ –î–ü –∏–∑–∏—Å–∫–≤–∞—Ç –¥—ä–ª–±–æ–∫–æ —Ä–∞–∑–±–∏—Ä–∞–Ω–µ –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ø—Ä–µ—Ö–æ–¥–∏—Ç–µ. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏—Ç–µ –∫–∞—Ç–æ CHT –∏ –º–∞—Ç—Ä–∏—á–Ω–æ—Ç–æ –ø–æ–≤–¥–∏–≥–∞–Ω–µ –ø–æ–∑–≤–æ–ª—è–≤–∞—Ç —Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ –∑–∞–¥–∞—á–∏ —Å –æ–≥—Ä–æ–º–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –∫–æ–∏—Ç–æ –∏–∑–≥–ª–µ–∂–¥–∞—Ç –Ω–µ–≤—ä–∑–º–æ–∂–Ω–∏ –Ω–∞ –ø—Ä—ä–≤ –ø–æ–≥–ª–µ–¥. üöÄ
